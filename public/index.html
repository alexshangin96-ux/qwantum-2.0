<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>⚛️ Quantum Nexus - Ultra Crypto Tapper</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #00d4aa;
            --primary-dark: #00b894;
            --secondary: #6c5ce7;
            --success: #00b894;
            --warning: #fdcb6e;
            --danger: #e17055;
            --info: #74b9ff;
            --crypto-gold: #f39c12;
            --crypto-silver: #95a5a6;
            --dark: #0f172a;
            --dark-light: #1e293b;
            --gray: #64748b;
            --gray-light: #94a3b8;
            --white: #ffffff;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-hover: rgba(255, 255, 255, 0.1);
            --border: rgba(255, 255, 255, 0.1);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #2d3748 100%);
            min-height: 100vh;
            color: var(--white);
            overflow-x: hidden;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            touch-action: manipulation;
        }

        /* Крипто-анимированный фон */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(0, 212, 170, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(108, 92, 231, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 184, 148, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 60% 60%, rgba(116, 185, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 30% 70%, rgba(243, 156, 18, 0.08) 0%, transparent 50%);
            animation: cryptoFloat 30s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes cryptoFloat {
            0%, 100% { transform: translate(0, 0) scale(1) rotate(0deg); }
            25% { transform: translate(-30px, -40px) scale(1.1) rotate(2deg); }
            50% { transform: translate(40px, -30px) scale(0.9) rotate(-2deg); }
            75% { transform: translate(-20px, 30px) scale(1.05) rotate(1deg); }
        }

        /* Крипто-частицы */
        .crypto-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .crypto-particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: var(--crypto-gold);
            border-radius: 50%;
            animation: cryptoParticleFloat 20s linear infinite;
            box-shadow: 0 0 10px var(--crypto-gold);
        }

        .crypto-particle:nth-child(odd) {
            background: var(--primary);
            box-shadow: 0 0 10px var(--primary);
        }

        @keyframes cryptoParticleFloat {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(200px) rotate(360deg);
                opacity: 0;
            }
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 15px;
            position: relative;
            z-index: 1;
        }

        /* Header */
        .header {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-xl);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 212, 170, 0.1), transparent);
            animation: cryptoShimmer 4s infinite;
        }

        @keyframes cryptoShimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .header-left h1 {
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--crypto-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .header-left p {
            color: var(--gray-light);
            font-size: 0.9rem;
        }

        .header-right {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 5px;
        }

        .level-info {
            background: var(--glass-hover);
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--crypto-gold);
            border: 1px solid var(--crypto-gold);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--crypto-gold));
        }

        .stat-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .stat-card-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--gray-light);
        }

        .stat-card-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .stat-card-icon.coins { 
            background: rgba(0, 184, 148, 0.2); 
            color: var(--success);
            border: 1px solid var(--success);
        }
        .stat-card-icon.hash { 
            background: rgba(243, 156, 18, 0.2); 
            color: var(--crypto-gold);
            border: 1px solid var(--crypto-gold);
        }

        .stat-card-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--white);
            margin-bottom: 5px;
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-card-change {
            font-size: 0.8rem;
            color: var(--gray-light);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stat-card-change.positive { color: var(--success); }
        .stat-card-change.negative { color: var(--danger); }

        /* Energy Bar */
        .energy-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .energy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .energy-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .energy-regen {
            font-size: 0.8rem;
            color: var(--gray-light);
            font-family: 'JetBrains Mono', monospace;
        }

        .energy-bar-container {
            position: relative;
            background: var(--glass-hover);
            border-radius: 12px;
            height: 20px;
            overflow: hidden;
        }

        .energy-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--crypto-gold));
            border-radius: 12px;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .energy-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: energyShimmer 2s infinite;
        }

        @keyframes energyShimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .energy-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--white);
            font-family: 'JetBrains Mono', monospace;
        }

        /* Tap Button - Квадратная кнопка по образцу */
        .tap-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .tap-button {
            width: 200px;
            height: 200px;
            border: none;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(0, 212, 170, 0.8), rgba(108, 92, 231, 0.8));
            color: white;
            font-size: 4rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.1s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 0 40px rgba(0, 212, 170, 0.4),
                0 0 80px rgba(108, 92, 231, 0.3),
                inset 0 0 30px rgba(255, 255, 255, 0.1);
            animation: cryptoPulse 3s ease-in-out infinite;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        @keyframes cryptoPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 
                    0 0 40px rgba(0, 212, 170, 0.4),
                    0 0 80px rgba(108, 92, 231, 0.3),
                    inset 0 0 30px rgba(255, 255, 255, 0.1);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 
                    0 0 60px rgba(0, 212, 170, 0.6),
                    0 0 120px rgba(108, 92, 231, 0.5),
                    inset 0 0 40px rgba(255, 255, 255, 0.15);
            }
        }

        .tap-button:hover {
            transform: scale(1.1);
            animation-play-state: paused;
        }

        .tap-button:active {
            transform: scale(0.95);
            animation-play-state: paused;
        }

        .tap-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, transparent 30%, rgba(255, 255, 255, 0.1) 100%);
            border-radius: 18px;
        }

        .tap-button::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
        }

        .tap-button:active::after {
            width: 100%;
            height: 100%;
        }

        .tap-power {
            margin-top: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            font-family: 'JetBrains Mono', monospace;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 6px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            padding: 12px 16px;
            text-align: center;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--gray-light);
            white-space: nowrap;
            min-width: 80px;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: var(--shadow);
        }

        .nav-tab:hover:not(.active) {
            background: var(--glass-hover);
            color: var(--white);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Shop Section */
        .shop-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .shop-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .shop-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--primary), var(--crypto-gold));
            border-radius: 2px;
        }

        .shop-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .shop-category {
            padding: 8px 16px;
            border: 1px solid var(--border);
            border-radius: 20px;
            background: var(--glass-hover);
            color: var(--gray-light);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .shop-category.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .shop-category:hover:not(.active) {
            background: var(--glass);
            color: var(--white);
        }

        .shop-items {
            display: grid;
            gap: 15px;
        }

        .shop-item {
            background: var(--glass-hover);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .shop-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .shop-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .shop-item-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 5px;
        }

        .shop-item-price {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--success);
            font-family: 'JetBrains Mono', monospace;
        }

        .shop-item-description {
            font-size: 0.9rem;
            color: var(--gray-light);
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .shop-item-effect {
            background: var(--glass);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 0.8rem;
            color: var(--info);
            font-weight: 600;
        }

        .shop-item-button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .shop-item-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .shop-item-button:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Mining Section */
        .mining-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .mining-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mining-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--crypto-gold), var(--info));
            border-radius: 2px;
        }

        .mining-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .mining-tab {
            flex: 1;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 12px;
            background: var(--glass-hover);
            color: var(--gray-light);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .mining-tab.active {
            background: var(--crypto-gold);
            color: white;
            border-color: var(--crypto-gold);
        }

        .mining-tab:hover:not(.active) {
            background: var(--glass);
            color: var(--white);
        }

        .mining-stats {
            background: var(--glass-hover);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .mining-stat {
            text-align: center;
        }

        .mining-stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--crypto-gold);
            font-family: 'JetBrains Mono', monospace;
        }

        .mining-stat-label {
            font-size: 0.8rem;
            color: var(--gray-light);
            margin-top: 5px;
        }

        /* QuanHash Mining */
        .quanhash-mining {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        .quanhash-mining h3 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quanhash-mining h3::before {
            content: '⛏️';
            font-size: 1.5rem;
        }

        .energy-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .energy-input {
            flex: 1;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: var(--glass);
            color: var(--white);
            font-size: 14px;
            text-align: center;
        }

        .energy-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.1);
        }

        .mine-button {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--crypto-gold), var(--warning));
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mine-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .mine-button:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .mining-info {
            background: var(--glass);
            border-radius: 8px;
            padding: 10px;
            font-size: 0.8rem;
            color: var(--gray-light);
            text-align: center;
        }

        /* Cards Section */
        .cards-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .cards-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cards-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--warning), var(--danger));
            border-radius: 2px;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .card-item {
            background: var(--glass-hover);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--warning);
        }

        .card-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .card-name {
            font-size: 1rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 5px;
        }

        .card-income {
            font-size: 0.9rem;
            color: var(--success);
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .card-price {
            font-size: 1.1rem;
            color: var(--warning);
            font-weight: 800;
            margin-top: 10px;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Leaderboard */
        .leaderboard-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .leaderboard-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .leaderboard-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--success), var(--warning));
            border-radius: 2px;
        }

        .leaderboard-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .leaderboard-tab {
            flex: 1;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: var(--glass-hover);
            color: var(--gray-light);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .leaderboard-tab.active {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }

        .leaderboard-tab:hover:not(.active) {
            background: var(--glass);
            color: var(--white);
        }

        .leaderboard-list {
            display: grid;
            gap: 10px;
        }

        .leaderboard-item {
            background: var(--glass-hover);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .leaderboard-item:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .leaderboard-rank {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .leaderboard-rank.top-1 { background: linear-gradient(135deg, #ffd700, #ffed4e); color: #000; }
        .leaderboard-rank.top-2 { background: linear-gradient(135deg, #c0c0c0, #e5e5e5); color: #000; }
        .leaderboard-rank.top-3 { background: linear-gradient(135deg, #cd7f32, #daa520); color: #fff; }

        .leaderboard-info {
            flex: 1;
        }

        .leaderboard-name {
            font-weight: 600;
            color: var(--white);
            margin-bottom: 2px;
        }

        .leaderboard-value {
            font-size: 0.9rem;
            color: var(--gray-light);
            font-family: 'JetBrains Mono', monospace;
        }

        /* News Section */
        .news-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .news-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .news-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--info), var(--primary));
            border-radius: 2px;
        }

        .news-item {
            background: var(--glass-hover);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .news-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--info);
        }

        .news-item:last-child {
            margin-bottom: 0;
        }

        .news-date {
            font-size: 0.8rem;
            color: var(--gray-light);
            margin-bottom: 10px;
            font-family: 'JetBrains Mono', monospace;
        }

        .news-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 10px;
        }

        .news-content {
            font-size: 0.9rem;
            color: var(--gray-light);
            line-height: 1.5;
        }

        /* Withdrawal Section */
        .withdrawal-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .withdrawal-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .withdrawal-rate {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border);
        }

        .rate-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 15px 0;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .rate-amount {
            color: var(--crypto-gold);
            font-family: 'JetBrains Mono', monospace;
        }

        .rate-arrow {
            color: var(--primary);
            font-size: 1.5rem;
        }

        .rate-usdt {
            color: var(--success);
            font-family: 'JetBrains Mono', monospace;
        }

        .rate-note {
            font-size: 0.8rem;
            color: var(--gray-light);
            text-align: center;
        }

        .withdrawal-balance {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border);
            text-align: center;
        }

        .balance-amount {
            font-size: 2rem;
            font-weight: 800;
            color: var(--crypto-gold);
            font-family: 'JetBrains Mono', monospace;
            margin: 10px 0;
        }

        .balance-usdt {
            font-size: 1rem;
            color: var(--success);
            font-weight: 600;
        }

        .withdrawal-form {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        .withdrawal-summary {
            background: var(--glass);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .summary-item:last-child {
            margin-bottom: 0;
        }

        .summary-item span:first-child {
            color: var(--gray-light);
        }

        .summary-item span:last-child {
            color: var(--white);
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .withdrawal-button {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .withdrawal-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .withdrawal-button:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
        }

        .withdrawal-history {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border);
        }

        .history-list {
            display: grid;
            gap: 10px;
        }

        .history-item {
            background: var(--glass);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-info {
            display: flex;
            flex-direction: column;
        }

        .history-amount {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--crypto-gold);
            font-family: 'JetBrains Mono', monospace;
        }

        .history-date {
            font-size: 0.8rem;
            color: var(--gray-light);
        }

        .history-status {
            padding: 5px 10px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .history-status.pending {
            background: rgba(253, 203, 110, 0.2);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .history-status.completed {
            background: rgba(0, 184, 148, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .history-status.failed {
            background: rgba(225, 112, 85, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        /* Daily Tasks Section */
        .daily-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .daily-login-section {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        .login-streak {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
        }

        .streak-info {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .streak-days {
            font-size: 2rem;
            font-weight: 800;
            color: var(--crypto-gold);
            font-family: 'JetBrains Mono', monospace;
        }

        .streak-label {
            font-size: 0.8rem;
            color: var(--gray-light);
        }

        .streak-reward {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--success);
            font-family: 'JetBrains Mono', monospace;
        }

        .claim-button {
            padding: 12px 20px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--crypto-gold), var(--warning));
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .claim-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .claim-button:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
        }

        .daily-tasks-section h3 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--white);
        }

        .tasks-grid {
            display: grid;
            gap: 15px;
        }

        .task-item {
            background: var(--glass-hover);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .task-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .task-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--white);
        }

        .task-reward {
            font-size: 1rem;
            font-weight: 600;
            color: var(--success);
            font-family: 'JetBrains Mono', monospace;
        }

        .task-description {
            font-size: 0.9rem;
            color: var(--gray-light);
            margin-bottom: 15px;
        }

        .task-progress {
            background: var(--glass);
            border-radius: 8px;
            height: 8px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .task-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--crypto-gold));
            transition: width 0.3s ease;
        }

        .task-progress-text {
            font-size: 0.8rem;
            color: var(--gray-light);
            text-align: center;
        }

        .task-button {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .task-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .task-button:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
        }

        /* Referral Section */
        .referral-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .referral-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .referral-code-section {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .referral-code {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--crypto-gold);
            font-family: 'JetBrains Mono', monospace;
            margin: 10px 0;
            padding: 10px;
            background: var(--glass);
            border-radius: 8px;
            border: 1px solid var(--crypto-gold);
        }

        .copy-button {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            background: var(--primary);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .copy-button:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .referral-stats {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border);
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .stat-label {
            color: var(--gray-light);
        }

        .stat-value {
            color: var(--white);
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .referral-rewards {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border);
        }

        .reward-list {
            display: grid;
            gap: 10px;
        }

        .reward-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: var(--glass);
            border-radius: 8px;
        }

        .reward-icon {
            font-size: 1.2rem;
        }

        .reward-text {
            color: var(--white);
            font-weight: 500;
        }

        /* Auto Mining Section */
        .auto-mining-section {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border);
        }

        .auto-mining-info {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .auto-mining-status,
        .auto-mining-rate,
        .auto-mining-level {
            background: var(--glass);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .status-label,
        .rate-label,
        .level-label {
            display: block;
            font-size: 0.8rem;
            color: var(--gray-light);
            margin-bottom: 5px;
        }

        .status-value,
        .rate-value,
        .level-value {
            display: block;
            font-size: 1rem;
            font-weight: 700;
            color: var(--white);
            font-family: 'JetBrains Mono', monospace;
        }

        .auto-mining-visualization {
            margin-bottom: 20px;
        }

        .mining-animation-container {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto 20px;
        }

        .mining-circle {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 2px solid var(--crypto-gold);
            border-radius: 50%;
            animation: miningRotate 4s linear infinite;
        }

        .mining-particle {
            position: absolute;
            width: 12px;
            height: 12px;
            background: var(--crypto-gold);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--crypto-gold);
        }

        .mining-particle:nth-child(1) { top: -6px; left: 50%; transform: translateX(-50%); }
        .mining-particle:nth-child(2) { bottom: -6px; left: 50%; transform: translateX(-50%); }
        .mining-particle:nth-child(3) { top: 50%; right: -6px; transform: translateY(-50%); }
        .mining-particle:nth-child(4) { top: 50%; left: -6px; transform: translateY(-50%); }

        .mining-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            animation: miningPulse 2s ease-in-out infinite;
        }

        .mining-progress {
            background: var(--glass);
            border-radius: 12px;
            padding: 15px;
        }

        .progress-bar {
            background: var(--glass-hover);
            border-radius: 8px;
            height: 8px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--crypto-gold), var(--primary));
            border-radius: 8px;
            animation: miningProgress 3s ease-in-out infinite;
        }

        .progress-text {
            text-align: center;
            font-size: 0.9rem;
            color: var(--gray-light);
        }

        .auto-mining-note {
            background: var(--glass);
            border-radius: 8px;
            padding: 10px;
            font-size: 0.8rem;
            color: var(--gray-light);
            text-align: center;
        }

        .manual-mining-locked {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border);
            text-align: center;
        }

        .lock-info {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .lock-icon {
            font-size: 3rem;
        }

        .lock-text p {
            margin-bottom: 10px;
            color: var(--gray-light);
        }

        .lock-text strong {
            color: var(--white);
        }

        .lock-progress {
            background: var(--glass);
            border-radius: 12px;
            padding: 15px;
        }

        @keyframes miningRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes miningPulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        @keyframes miningProgress {
            0%, 100% { width: 0%; }
            50% { width: 100%; }
        }

        /* Support Section */
        .support-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .support-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .support-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--warning), var(--danger));
            border-radius: 2px;
        }

        .support-form {
            display: grid;
            gap: 15px;
        }

        .form-group {
            display: grid;
            gap: 8px;
        }

        .form-group label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--white);
        }

        .form-group select,
        .form-group textarea {
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: var(--glass);
            color: var(--white);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .support-button {
            padding: 15px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--warning), var(--danger));
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .support-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 24px;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            animation: slideInDown 0.3s ease-out;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: var(--shadow-lg);
            max-width: 90%;
        }

        .notification.success {
            background: linear-gradient(135deg, var(--success), #059669);
        }

        .notification.error {
            background: linear-gradient(135deg, var(--danger), #dc2626);
        }

        .notification.info {
            background: linear-gradient(135deg, var(--info), #0891b2);
        }

        @keyframes slideInDown {
            from { opacity: 0; transform: translateX(-50%) translateY(-100%); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        /* Tap Effects */
        .tap-effect {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--success);
            animation: tapEffectAnimation 1s ease-out forwards;
            text-shadow: 0 0 10px rgba(0, 184, 148, 0.5);
        }

        @keyframes tapEffectAnimation {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5);
            }
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .tap-button {
                width: 160px;
                height: 160px;
                font-size: 3rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .shop-categories {
                flex-wrap: wrap;
            }
            
            .cards-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
        }

        /* Telegram Web App specific styles */
        .tg-viewport {
            height: 100vh;
            overflow: hidden;
        }

        .tg-main-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 15px;
            font-weight: 600;
            cursor: pointer;
            z-index: 100;
            box-shadow: var(--shadow-lg);
        }

        /* Anti-clicker protection */
        .tap-protection {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 999;
            pointer-events: none;
        }

        .tap-protection.active {
            pointer-events: all;
            background: rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div class="crypto-particles" id="cryptoParticles"></div>
    
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="header-left">
                    <h1>⚛️ Quantum Nexus</h1>
                    <p>Ultra Crypto Tapper</p>
                </div>
                <div class="header-right">
                    <div class="level-info" id="levelInfo">
                        Уровень <span id="userLevel">1</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-card-header">
                    <div class="stat-card-title">💰 Монеты</div>
                    <div class="stat-card-icon coins">🪙</div>
                </div>
                <div class="stat-card-value" id="coinsValue">0</div>
                <div class="stat-card-change positive" id="coinsPerHour">
                    <span>↗</span>
                    <span>+0/час</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-card-header">
                    <div class="stat-card-title">⛏️ QuanHash</div>
                    <div class="stat-card-icon hash">₿</div>
                </div>
                <div class="stat-card-value" id="hashValue">0</div>
                <div class="stat-card-change positive" id="hashPerHour">
                    <span>↗</span>
                    <span>+0/час</span>
                </div>
            </div>
        </div>

        <!-- Energy Bar -->
        <div class="energy-section">
            <div class="energy-header">
                <div class="energy-title">
                    <span>⚡</span>
                    <span>Энергия</span>
                </div>
                <div class="energy-regen" id="energyRegen">+0.1/сек</div>
            </div>
            <div class="energy-bar-container">
                <div class="energy-bar" id="energyBar" style="width: 100%"></div>
                <div class="energy-text" id="energyText">1000/1000</div>
            </div>
        </div>

        <!-- Tap Button -->
        <div class="tap-section">
            <button class="tap-button" id="tapButton" onclick="tap()">
                ⚛️
            </button>
            <div class="tap-power" id="tapPower">+1 за клик</div>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="switchTab('shop')">🛒 Магазин</div>
            <div class="nav-tab" onclick="switchTab('mining')">⛏️ Майнинг</div>
            <div class="nav-tab" onclick="switchTab('withdraw')">💰 Вывод</div>
            <div class="nav-tab" onclick="switchTab('daily')">📅 Задания</div>
            <div class="nav-tab" onclick="switchTab('referral')">👥 Рефералы</div>
            <div class="nav-tab" onclick="switchTab('cards')">🃏 Карты</div>
            <div class="nav-tab" onclick="switchTab('leaderboard')">🏆 Топ</div>
            <div class="nav-tab" onclick="switchTab('news')">📰 Новости</div>
            <div class="nav-tab" onclick="switchTab('support')">🆘 Поддержка</div>
        </div>

        <!-- Shop Tab -->
        <div class="tab-content active" id="shopTab">
            <div class="shop-section">
                <h2>🛒 Магазин Бустов</h2>
                <div class="shop-categories">
                    <div class="shop-category active" onclick="switchShopCategory('tap')">Тап</div>
                    <div class="shop-category" onclick="switchShopCategory('energy')">Энергия</div>
                    <div class="shop-category" onclick="switchShopCategory('passive')">Пассивный доход</div>
                    <div class="shop-category" onclick="switchShopCategory('auto')">Автотап</div>
                </div>
                
                <div class="shop-items" id="shopItems">
                    <!-- Shop items will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- Mining Tab -->
        <div class="tab-content" id="miningTab">
            <div class="mining-section">
                <h2>⛏️ Майнинг QuanHash</h2>
                <div class="mining-tabs">
                    <div class="mining-tab active" onclick="switchMiningTab('machines')">Машины</div>
                    <div class="mining-tab" onclick="switchMiningTab('premium')">Премиум</div>
                    <div class="mining-tab" onclick="switchMiningTab('manual')">Ручная добыча</div>
                </div>
                
                <div class="mining-stats">
                    <div class="mining-stat">
                        <div class="mining-stat-value" id="totalHashPerHour">0</div>
                        <div class="mining-stat-label">QuanHash/час</div>
                    </div>
                    <div class="mining-stat">
                        <div class="mining-stat-value" id="totalMachines">0</div>
                        <div class="mining-stat-label">Машин</div>
                    </div>
                </div>
                
                <div class="mining-content" id="miningContent">
                    <!-- Mining content will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- Withdrawal Tab -->
        <div class="tab-content" id="withdrawTab">
            <div class="withdrawal-section">
                <h2>💰 Вывод USDT</h2>
                
                <div class="withdrawal-info">
                    <div class="withdrawal-rate">
                        <h3>💱 Курс обмена</h3>
                        <div class="rate-info">
                            <span class="rate-amount">500,000 QuanHash</span>
                            <span class="rate-arrow">→</span>
                            <span class="rate-usdt">1 USDT</span>
                        </div>
                        <div class="rate-note">Вывод в сети BEP20 (Binance Smart Chain)</div>
                    </div>
                    
                    <div class="withdrawal-balance">
                        <h3>💎 Ваш баланс QuanHash</h3>
                        <div class="balance-amount" id="withdrawalBalance">0</div>
                        <div class="balance-usdt">≈ 0 USDT</div>
                    </div>
                </div>
                
                <div class="withdrawal-form">
                    <h3>📝 Заявка на вывод</h3>
                    <div class="form-group">
                        <label for="usdtAddress">USDT адрес кошелька (BEP20):</label>
                        <input type="text" id="usdtAddress" placeholder="0x..." maxlength="42">
                    </div>
                    <div class="form-group">
                        <label for="withdrawalAmount">Количество QuanHash для вывода:</label>
                        <input type="number" id="withdrawalAmount" value="500000" min="500000" max="500000" readonly>
                    </div>
                    <div class="withdrawal-summary">
                        <div class="summary-item">
                            <span>К выводу:</span>
                            <span>500,000 QuanHash</span>
                        </div>
                        <div class="summary-item">
                            <span>Получите:</span>
                            <span>1 USDT</span>
                        </div>
                        <div class="summary-item">
                            <span>Комиссия:</span>
                            <span>0%</span>
                        </div>
                    </div>
                    <button class="withdrawal-button" id="withdrawButton" onclick="submitWithdrawal()">Вывести USDT</button>
                </div>
                
                <div class="withdrawal-history">
                    <h3>📋 История выводов</h3>
                    <div class="history-list" id="withdrawalHistory">
                        <!-- History will be loaded dynamically -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Daily Tasks Tab -->
        <div class="tab-content" id="dailyTab">
            <div class="daily-section">
                <h2>📅 Ежедневные Задания</h2>
                
                <!-- Daily Login Bonus -->
                <div class="daily-login-section">
                    <h3>🎁 Ежедневный бонус за вход</h3>
                    <div class="login-streak">
                        <div class="streak-info">
                            <span class="streak-days" id="loginStreak">0</span>
                            <span class="streak-label">дней подряд</span>
                        </div>
                        <div class="streak-reward" id="loginReward">+100 монет</div>
                        <button class="claim-button" id="claimLoginBonus" onclick="claimLoginBonus()">Получить бонус</button>
                    </div>
                </div>
                
                <!-- Daily Tasks -->
                <div class="daily-tasks-section">
                    <h3>🎯 Ежедневные задания</h3>
                    <div class="tasks-grid" id="dailyTasksGrid">
                        <!-- Tasks will be loaded dynamically -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Referral Tab -->
        <div class="tab-content" id="referralTab">
            <div class="referral-section">
                <h2>👥 Реферальная система</h2>
                
                <div class="referral-info">
                    <div class="referral-code-section">
                        <h3>🔗 Ваш реферальный код</h3>
                        <div class="referral-code" id="referralCode">QUANTUM123</div>
                        <button class="copy-button" onclick="copyReferralCode()">Копировать</button>
                    </div>
                    
                    <div class="referral-stats">
                        <div class="stat-item">
                            <span class="stat-label">Приглашено:</span>
                            <span class="stat-value" id="referralsCount">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Заработано:</span>
                            <span class="stat-value" id="referralEarnings">0 монет</span>
                        </div>
                    </div>
                </div>
                
                <div class="referral-rewards">
                    <h3>💰 Бонусы за приглашения</h3>
                    <div class="reward-list">
                        <div class="reward-item">
                            <span class="reward-icon">🎁</span>
                            <span class="reward-text">За каждого реферала: +1000 монет</span>
                        </div>
                        <div class="reward-item">
                            <span class="reward-icon">⚡</span>
                            <span class="reward-text">За каждого реферала: +50 QuanHash</span>
                        </div>
                        <div class="reward-item">
                            <span class="reward-icon">🏆</span>
                            <span class="reward-text">За 10 рефералов: +10000 монет</span>
                        </div>
                        <div class="reward-item">
                            <span class="reward-icon">💎</span>
                            <span class="reward-text">За 50 рефералов: +100000 монет</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cards Tab -->
        <div class="tab-content" id="cardsTab">
            <div class="cards-section">
                <h2>🃏 Коллекция Карт</h2>
                <div class="cards-grid" id="cardsGrid">
                    <!-- Cards will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- Leaderboard Tab -->
        <div class="tab-content" id="leaderboardTab">
            <div class="leaderboard-section">
                <h2>🏆 Лидерборд</h2>
                <div class="leaderboard-tabs">
                    <div class="leaderboard-tab active" onclick="switchLeaderboardTab('coins')">Монеты</div>
                    <div class="leaderboard-tab" onclick="switchLeaderboardTab('hash')">QuanHash</div>
                </div>
                <div class="leaderboard-list" id="leaderboardList">
                    <!-- Leaderboard will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- News Tab -->
        <div class="tab-content" id="newsTab">
            <div class="news-section">
                <h2>📰 Новости Quantum Nexus</h2>
                <div id="newsContent">
                    <!-- News will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- Support Tab -->
        <div class="tab-content" id="supportTab">
            <div class="support-section">
                <h2>🆘 Поддержка</h2>
                <form class="support-form" id="supportForm">
                    <div class="form-group">
                        <label for="supportCategory">Категория проблемы:</label>
                        <select id="supportCategory" required>
                            <option value="">Выберите категорию</option>
                            <option value="technical">Технические проблемы</option>
                            <option value="gameplay">Игровой процесс</option>
                            <option value="balance">Проблемы с балансом</option>
                            <option value="bug">Ошибки и баги</option>
                            <option value="suggestion">Предложения</option>
                            <option value="other">Другое</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="supportMessage">Опишите проблему:</label>
                        <textarea id="supportMessage" placeholder="Подробно опишите вашу проблему или предложение..." required></textarea>
                    </div>
                    <button type="submit" class="support-button">Отправить сообщение</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Anti-clicker protection overlay -->
    <div class="tap-protection" id="tapProtection"></div>

    <script>
        // Game state
        let gameState = {
            user: null,
            coins: 0,
            quanhash: 0,
            level: 1,
            experience: 0,
            energy: 1000,
            maxEnergy: 1000,
            energyRegenRate: 0.1,
            coinsPerHour: 0,
            hashPerHour: 0,
            tapPower: 1,
            autoTapHours: 0,
            autoTapEndTime: 0,
            isBanned: false,
            isFrozen: false,
            freezeEndTime: 0,
            offlineCoins: 0,
            offlineHash: 0,
            hoursOffline: 0
        };

        let currentTab = 'shop';
        let currentShopCategory = 'tap';
        let currentMiningTab = 'machines';
        let currentLeaderboardTab = 'coins';
        let lastTapTime = 0;
        let tapCount = 0;
        let tapStartTime = Date.now();

        // Initialize Telegram Web App
        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
            window.Telegram.WebApp.MainButton.hide();
        }

        // Create crypto particles
        function createCryptoParticles() {
            const particlesContainer = document.getElementById('cryptoParticles');
            const particleCount = 25;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'crypto-particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (20 + Math.random() * 10) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Initialize game
        async function initGame() {
            try {
                // Get Telegram init data
                const initData = window.Telegram?.WebApp?.initData || '';
                
                const response = await fetch('/api/auth', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': initData
                    },
                    body: JSON.stringify({ initData })
                });

                const data = await response.json();
                
                if (data.success) {
                    gameState = { ...gameState, ...data.user };
                    updateUI();
                    
                    // Show beautiful offline earnings popup
                    if (gameState.offlineCoins > 0 || gameState.offlineHash > 0) {
                        showOfflineEarningsPopup();
                    }
                    
                    loadShopItems();
                    loadMiningContent();
                    loadWithdrawalInfo();
                    loadDailyTasks();
                    loadReferralInfo();
                    loadCards();
                    loadLeaderboard();
                    loadNews();
                } else {
                    showNotification('❌ Ошибка авторизации!', 'error');
                }
            } catch (error) {
                console.error('Ошибка инициализации:', error);
                showNotification('❌ Ошибка подключения к серверу!', 'error');
            }
        }

        // Update UI
        function updateUI() {
            document.getElementById('coinsValue').textContent = gameState.coins.toLocaleString();
            document.getElementById('hashValue').textContent = gameState.quanhash.toLocaleString();
            document.getElementById('userLevel').textContent = gameState.level;
            document.getElementById('tapPower').textContent = `+${gameState.tapPower} за клик`;
            document.getElementById('coinsPerHour').innerHTML = `<span>↗</span><span>+${gameState.coinsPerHour}/час</span>`;
            document.getElementById('hashPerHour').innerHTML = `<span>↗</span><span>+${gameState.hashPerHour}/час</span>`;
            
            // Update energy
            const energyPercent = (gameState.energy / gameState.maxEnergy) * 100;
            document.getElementById('energyBar').style.width = energyPercent + '%';
            document.getElementById('energyText').textContent = `${gameState.energy}/${gameState.maxEnergy}`;
            document.getElementById('energyRegen').textContent = `+${gameState.energyRegenRate}/сек`;
            
            // Update mining stats
            document.getElementById('totalHashPerHour').textContent = gameState.hashPerHour.toLocaleString();
        }

        // Anti-clicker protection
        function checkAntiClicker() {
            const now = Date.now();
            const timeSinceLastTap = now - lastTapTime;
            
            // Check for too fast tapping (less than 100ms between taps)
            if (timeSinceLastTap < 100) {
                tapCount++;
                if (tapCount > 5) {
                    showNotification('⚠️ Слишком быстрый тап! Подозрение на автокликер.', 'error');
                    return false;
                }
            } else {
                tapCount = 0;
            }
            
            // Check for human-like tapping patterns
            const timeSinceStart = now - tapStartTime;
            if (timeSinceStart > 10000) { // After 10 seconds
                const avgTapInterval = timeSinceStart / Math.max(tapCount, 1);
                if (avgTapInterval < 200) { // Less than 200ms average
                    showNotification('⚠️ Обнаружена подозрительная активность!', 'error');
                    return false;
                }
            }
            
            lastTapTime = now;
            return true;
        }

        // Tap function with anti-clicker protection
        async function tap() {
            if (!checkAntiClicker()) {
                return;
            }

            if (gameState.energy < 1) {
                showNotification('❌ Недостаточно энергии!', 'error');
                return;
            }

            try {
                const response = await fetch('/api/tap', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    }
                });

                const data = await response.json();
                
                if (data.success) {
                    gameState.coins += data.coinsEarned;
                    gameState.experience += data.experienceEarned;
                    gameState.energy = data.newEnergy;
                    
                    updateUI();
                    
                    // Show tap effect
                    showTapEffect(data.coinsEarned);
                    
                    // Check for level up
                    const newLevel = Math.floor(gameState.experience / 1000) + 1;
                    if (newLevel > gameState.level) {
                        gameState.level = newLevel;
                        showNotification(`🎉 Уровень повышен до ${newLevel}!`, 'success');
                        updateUI();
                    }
                } else {
                    showNotification(data.error || '❌ Ошибка тапа!', 'error');
                }
            } catch (error) {
                console.error('Ошибка тапа:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        // Show tap effect
        function showTapEffect(amount) {
            const effect = document.createElement('div');
            effect.className = 'tap-effect';
            effect.textContent = `+${amount}`;
            effect.style.left = Math.random() * 200 + 140 + 'px';
            effect.style.top = Math.random() * 100 + 300 + 'px';
            document.body.appendChild(effect);
            
            setTimeout(() => {
                effect.remove();
            }, 1000);
        }

        // Switch tabs
        function switchTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.nav-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tab + 'Tab').classList.add('active');
            
            currentTab = tab;
        }

        // Shop functions
        function switchShopCategory(category) {
            document.querySelectorAll('.shop-category').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            currentShopCategory = category;
            loadShopItems();
        }

        function loadShopItems() {
            const shopItems = {
                tap: [
                    { id: 'tap_power_1', name: 'Усилитель Тапа', price: 100, description: 'Увеличивает силу тапа', effect: '+1 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_2', name: 'Мега Усилитель', price: 200, description: 'Значительно увеличивает силу тапа', effect: '+2 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_5', name: 'Ультра Усилитель', price: 450, description: 'Максимально увеличивает силу тапа', effect: '+5 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_10', name: 'Квантовый Усилитель', price: 800, description: 'Квантовое усиление силы тапа', effect: '+10 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_20', name: 'Нексус Усилитель', price: 1500, description: 'Нексус-уровень усиления', effect: '+20 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_50', name: 'Космический Усилитель', price: 3000, description: 'Космическое усиление силы', effect: '+50 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_100', name: 'Божественный Усилитель', price: 6000, description: 'Божественная сила тапа', effect: '+100 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_200', name: 'Бесконечный Усилитель', price: 12000, description: 'Бесконечная сила тапа', effect: '+200 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_500', name: 'Легендарный Усилитель', price: 25000, description: 'Легендарная сила тапа', effect: '+500 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_1000', name: 'Мифический Усилитель', price: 50000, description: 'Мифическая сила тапа', effect: '+1000 к силе тапа', coinsPerHour: 0 }
                ],
                energy: [
                    { id: 'energy_capacity_100', name: 'Расширитель Энергии', price: 200, description: 'Увеличивает максимальную энергию', effect: '+100 к максимальной энергии', coinsPerHour: 0 },
                    { id: 'energy_capacity_200', name: 'Мега Расширитель', price: 400, description: 'Значительно увеличивает энергию', effect: '+200 к максимальной энергии', coinsPerHour: 0 },
                    { id: 'energy_capacity_500', name: 'Ультра Расширитель', price: 800, description: 'Максимально увеличивает энергию', effect: '+500 к максимальной энергии', coinsPerHour: 0 },
                    { id: 'energy_capacity_1000', name: 'Квантовый Расширитель', price: 1500, description: 'Квантовое расширение энергии', effect: '+1000 к максимальной энергии', coinsPerHour: 0 },
                    { id: 'energy_regen_01', name: 'Регенератор', price: 300, description: 'Ускоряет восстановление энергии', effect: '+0.1 к скорости восстановления', coinsPerHour: 0 },
                    { id: 'energy_regen_02', name: 'Мега Регенератор', price: 600, description: 'Значительно ускоряет восстановление', effect: '+0.2 к скорости восстановления', coinsPerHour: 0 },
                    { id: 'energy_regen_05', name: 'Ультра Регенератор', price: 1200, description: 'Максимально ускоряет восстановление', effect: '+0.5 к скорости восстановления', coinsPerHour: 0 },
                    { id: 'energy_regen_1', name: 'Квантовый Регенератор', price: 2000, description: 'Квантовая регенерация', effect: '+1.0 к скорости восстановления', coinsPerHour: 0 },
                    { id: 'energy_regen_2', name: 'Нексус Регенератор', price: 4000, description: 'Нексус-уровень регенерации', effect: '+2.0 к скорости восстановления', coinsPerHour: 0 },
                    { id: 'energy_regen_5', name: 'Космический Регенератор', price: 8000, description: 'Космическая регенерация', effect: '+5.0 к скорости восстановления', coinsPerHour: 0 }
                ],
                passive: [
                    { id: 'coins_per_hour_50', name: 'Пассивный Доход', price: 500, description: 'Генерирует монеты каждый час', effect: '+50 монет/час', coinsPerHour: 50 },
                    { id: 'coins_per_hour_100', name: 'Усиленный Доход', price: 900, description: 'Больше пассивного дохода', effect: '+100 монет/час', coinsPerHour: 100 },
                    { id: 'coins_per_hour_200', name: 'Максимальный Доход', price: 1600, description: 'Максимальный пассивный доход', effect: '+200 монет/час', coinsPerHour: 200 },
                    { id: 'coins_per_hour_500', name: 'Квантовый Доход', price: 3000, description: 'Квантовый пассивный доход', effect: '+500 монет/час', coinsPerHour: 500 },
                    { id: 'coins_per_hour_1000', name: 'Нексус Доход', price: 6000, description: 'Нексус-уровень дохода', effect: '+1000 монет/час', coinsPerHour: 1000 },
                    { id: 'coins_per_hour_2000', name: 'Космический Доход', price: 12000, description: 'Космический пассивный доход', effect: '+2000 монет/час', coinsPerHour: 2000 },
                    { id: 'coins_per_hour_5000', name: 'Божественный Доход', price: 25000, description: 'Божественный пассивный доход', effect: '+5000 монет/час', coinsPerHour: 5000 },
                    { id: 'coins_per_hour_10000', name: 'Бесконечный Доход', price: 50000, description: 'Бесконечный пассивный доход', effect: '+10000 монет/час', coinsPerHour: 10000 },
                    { id: 'coins_per_hour_20000', name: 'Легендарный Доход', price: 100000, description: 'Легендарный пассивный доход', effect: '+20000 монет/час', coinsPerHour: 20000 },
                    { id: 'coins_per_hour_50000', name: 'Мифический Доход', price: 200000, description: 'Мифический пассивный доход', effect: '+50000 монет/час', coinsPerHour: 50000 }
                ],
                auto: [
                    { id: 'auto_tap_1h', name: 'Автотап 1ч', price: 1000, description: 'Автоматический тап на 1 час', effect: 'Автотап на 1 час', coinsPerHour: 0 },
                    { id: 'auto_tap_3h', name: 'Автотап 3ч', price: 2500, description: 'Автоматический тап на 3 часа', effect: 'Автотап на 3 часа', coinsPerHour: 0 },
                    { id: 'auto_tap_6h', name: 'Автотап 6ч', price: 4500, description: 'Автоматический тап на 6 часов', effect: 'Автотап на 6 часов', coinsPerHour: 0 },
                    { id: 'auto_tap_12h', name: 'Автотап 12ч', price: 8000, description: 'Автоматический тап на 12 часов', effect: 'Автотап на 12 часов', coinsPerHour: 0 },
                    { id: 'auto_tap_24h', name: 'Автотап 24ч', price: 15000, description: 'Автоматический тап на 24 часа', effect: 'Автотап на 24 часа', coinsPerHour: 0 },
                    { id: 'auto_tap_48h', name: 'Автотап 48ч', price: 28000, description: 'Автоматический тап на 48 часов', effect: 'Автотап на 48 часов', coinsPerHour: 0 },
                    { id: 'auto_tap_72h', name: 'Автотап 72ч', price: 50000, description: 'Автоматический тап на 72 часа', effect: 'Автотап на 72 часа', coinsPerHour: 0 },
                    { id: 'auto_tap_168h', name: 'Автотап 7д', price: 100000, description: 'Автоматический тап на 7 дней', effect: 'Автотап на 7 дней', coinsPerHour: 0 },
                    { id: 'auto_tap_720h', name: 'Автотап 30д', price: 500000, description: 'Автоматический тап на 30 дней', effect: 'Автотап на 30 дней', coinsPerHour: 0 },
                    { id: 'auto_tap_infinite', name: 'Бесконечный Автотап', price: 1000000, description: 'Бесконечный автоматический тап', effect: 'Бесконечный автотап', coinsPerHour: 0 }
                ]
            };

            const items = shopItems[currentShopCategory] || [];
            const container = document.getElementById('shopItems');
            
            container.innerHTML = items.map(item => `
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div>
                            <div class="shop-item-title">${item.name}</div>
                            <div class="shop-item-description">${item.description}</div>
                        </div>
                        <div class="shop-item-price">${item.price.toLocaleString()}</div>
                    </div>
                    <div class="shop-item-effect">${item.effect}</div>
                    <button class="shop-item-button" onclick="buyBoost('${item.id}')" ${gameState.coins < item.price ? 'disabled' : ''}>
                        ${gameState.coins < item.price ? 'Недостаточно монет' : 'Купить'}
                    </button>
                </div>
            `).join('');
        }

        async function buyBoost(boostId) {
            try {
                const response = await fetch('/api/buy-boost', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ boostId, boostType: 'boost' })
                });

                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.coins = data.newBalance;
                    updateUI();
                    loadShopItems();
                } else {
                    showNotification(data.error || '❌ Ошибка покупки!', 'error');
                }
            } catch (error) {
                console.error('Ошибка покупки:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        // Mining functions
        function switchMiningTab(tab) {
            document.querySelectorAll('.mining-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            currentMiningTab = tab;
            loadMiningContent();
        }

        function loadMiningContent() {
            const container = document.getElementById('miningContent');
            
            if (currentMiningTab === 'machines') {
                const machines = [
                    { id: 'basic_miner', name: 'Базовый Майнер', price: 25000, hashPerHour: 2, description: 'Простая майнинг машина' },
                    { id: 'advanced_miner', name: 'Продвинутый Майнер', price: 125000, hashPerHour: 10, description: 'Улучшенная майнинг машина' },
                    { id: 'quantum_miner', name: 'Квантовый Майнер', price: 375000, hashPerHour: 30, description: 'Высокотехнологичный майнер' },
                    { id: 'nexus_miner', name: 'Nexus Майнер', price: 1250000, hashPerHour: 100, description: 'Элитная майнинг машина' },
                    { id: 'ultra_miner', name: 'Ультра Майнер', price: 3750000, hashPerHour: 300, description: 'Легендарная майнинг машина' },
                    { id: 'cosmic_miner', name: 'Космический Майнер', price: 12500000, hashPerHour: 1000, description: 'Космическая майнинг машина' },
                    { id: 'divine_miner', name: 'Божественный Майнер', price: 37500000, hashPerHour: 3000, description: 'Божественная майнинг машина' },
                    { id: 'infinite_miner', name: 'Бесконечный Майнер', price: 125000000, hashPerHour: 10000, description: 'Бесконечная майнинг машина' },
                    { id: 'legendary_miner', name: 'Легендарный Майнер', price: 375000000, hashPerHour: 30000, description: 'Легендарная майнинг машина' },
                    { id: 'mythical_miner', name: 'Мифический Майнер', price: 1250000000, hashPerHour: 100000, description: 'Мифическая майнинг машина' }
                ];
                
                container.innerHTML = machines.map(machine => `
                    <div class="shop-item">
                        <div class="shop-item-header">
                            <div>
                                <div class="shop-item-title">${machine.name}</div>
                                <div class="shop-item-description">${machine.description}</div>
                            </div>
                            <div class="shop-item-price">${machine.price.toLocaleString()}</div>
                        </div>
                        <div class="shop-item-effect">+${machine.hashPerHour} QuanHash/час</div>
                        <button class="shop-item-button" onclick="buyMiningMachine('${machine.id}')" ${gameState.coins < machine.price ? 'disabled' : ''}>
                            ${gameState.coins < machine.price ? 'Недостаточно монет' : 'Купить за монеты'}
                        </button>
                    </div>
                `).join('');
            } else if (currentMiningTab === 'premium') {
                const premiumMachines = [
                    { id: 'quantum_core', name: 'Квантовое Ядро', price: 25000, hashPerHour: 200, description: 'Премиум майнинг ядро' },
                    { id: 'nexus_core', name: 'Nexus Ядро', price: 125000, hashPerHour: 1000, description: 'Элитное майнинг ядро' },
                    { id: 'ultra_core', name: 'Ультра Ядро', price: 375000, hashPerHour: 3000, description: 'Легендарное майнинг ядро' },
                    { id: 'infinity_core', name: 'Бесконечное Ядро', price: 1250000, hashPerHour: 10000, description: 'Мифическое майнинг ядро' },
                    { id: 'cosmic_core', name: 'Космическое Ядро', price: 3750000, hashPerHour: 30000, description: 'Божественное майнинг ядро' },
                    { id: 'divine_core', name: 'Божественное Ядро', price: 12500000, hashPerHour: 100000, description: 'Божественное майнинг ядро' },
                    { id: 'eternal_core', name: 'Вечное Ядро', price: 37500000, hashPerHour: 300000, description: 'Вечное майнинг ядро' },
                    { id: 'legendary_core', name: 'Легендарное Ядро', price: 125000000, hashPerHour: 1000000, description: 'Легендарное майнинг ядро' },
                    { id: 'mythical_core', name: 'Мифическое Ядро', price: 375000000, hashPerHour: 3000000, description: 'Мифическое майнинг ядро' },
                    { id: 'omnipotent_core', name: 'Всемогущее Ядро', price: 1250000000, hashPerHour: 10000000, description: 'Всемогущее майнинг ядро' }
                ];
                
                container.innerHTML = premiumMachines.map(machine => `
                    <div class="shop-item">
                        <div class="shop-item-header">
                            <div>
                                <div class="shop-item-title">${machine.name}</div>
                                <div class="shop-item-description">${machine.description}</div>
                            </div>
                            <div class="shop-item-price">${machine.price.toLocaleString()} QuanHash</div>
                        </div>
                        <div class="shop-item-effect">+${machine.hashPerHour} QuanHash/час</div>
                        <button class="shop-item-button" onclick="buyPremiumMachine('${machine.id}')" ${gameState.quanhash < machine.price ? 'disabled' : ''}>
                            ${gameState.quanhash < machine.price ? 'Недостаточно QuanHash' : 'Купить за QuanHash'}
                        </button>
                    </div>
                `).join('');
            } else if (currentMiningTab === 'manual') {
                if (gameState.level >= 50) {
                    container.innerHTML = `
                        <div class="auto-mining-section">
                            <h3>🤖 Автоматическая добыча QuanHash</h3>
                            <div class="auto-mining-info">
                                <div class="auto-mining-status">
                                    <span class="status-label">Статус:</span>
                                    <span class="status-value" id="autoMiningStatus">Активна</span>
                                </div>
                                <div class="auto-mining-rate">
                                    <span class="rate-label">Скорость:</span>
                                    <span class="rate-value" id="autoMiningRate">0.1 QuanHash/час</span>
                                </div>
                                <div class="auto-mining-level">
                                    <span class="level-label">Требуется уровень:</span>
                                    <span class="level-value">50+</span>
                                </div>
                            </div>
                            <div class="auto-mining-visualization">
                                <div class="mining-animation-container">
                                    <div class="mining-circle" id="miningCircle">
                                        <div class="mining-particle" id="particle1"></div>
                                        <div class="mining-particle" id="particle2"></div>
                                        <div class="mining-particle" id="particle3"></div>
                                        <div class="mining-particle" id="particle4"></div>
                                    </div>
                                    <div class="mining-center">⛏️</div>
                                </div>
                                <div class="mining-progress">
                                    <div class="progress-bar" id="autoMiningProgress"></div>
                                    <div class="progress-text" id="autoMiningProgressText">Добыча активна...</div>
                                </div>
                            </div>
                            <div class="auto-mining-note">
                                💡 Автоматическая добыча работает в фоне и продолжается 3 часа оффлайн
                            </div>
                        </div>
                    `;
                    
                    // Start auto mining visualization
                    startAutoMiningVisualization();
                } else {
                    container.innerHTML = `
                        <div class="manual-mining-locked">
                            <h3>🔒 Автоматическая добыча заблокирована</h3>
                            <div class="lock-info">
                                <div class="lock-icon">🔐</div>
                                <div class="lock-text">
                                    <p>Для доступа к автоматической добыче QuanHash необходимо достичь <strong>50 уровня</strong></p>
                                    <p>Ваш текущий уровень: <strong>${gameState.level}</strong></p>
                                    <p>Осталось: <strong>${50 - gameState.level} уровней</strong></p>
                                </div>
                            </div>
                            <div class="lock-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(gameState.level / 50) * 100}%"></div>
                                </div>
                                <div class="progress-text">${gameState.level}/50 уровней</div>
                            </div>
                        </div>
                    `;
                }
            }
        }

        async function buyMiningMachine(machineId) {
            try {
                const response = await fetch('/api/buy-mining-machine', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ machineId })
                });

                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.coins = data.newBalance;
                    gameState.hashPerHour = data.newHashPerHour;
                    updateUI();
                    loadMiningContent();
                } else {
                    showNotification(data.error || '❌ Ошибка покупки!', 'error');
                }
            } catch (error) {
                console.error('Ошибка покупки машины:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        async function buyPremiumMachine(machineId) {
            try {
                const response = await fetch('/api/buy-premium-machine', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ machineId })
                });

                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.quanhash = data.newQuanHash;
                    gameState.hashPerHour = data.newHashPerHour;
                    updateUI();
                    loadMiningContent();
                } else {
                    showNotification(data.error || '❌ Ошибка покупки!', 'error');
                }
            } catch (error) {
                console.error('Ошибка покупки премиум машины:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        async function mineQuanHash() {
            const energyAmount = parseInt(document.getElementById('energyAmount').value);
            
            if (!energyAmount || energyAmount < 10 || energyAmount > 100) {
                showNotification('❌ Введите количество энергии от 10 до 100!', 'error');
                return;
            }

            try {
                const response = await fetch('/api/mine-quanhash', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ energyAmount })
                });

                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.quanhash = data.newQuanHash;
                    gameState.energy = data.newEnergy;
                    updateUI();
                } else {
                    showNotification(data.error || '❌ Ошибка добычи!', 'error');
                }
            } catch (error) {
                console.error('Ошибка добычи QuanHash:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        // Cards functions
        function loadCards() {
            const cards = [
                { id: 'quantum_card', name: 'Квантовая Карта', icon: '⚛️', income: 25, price: 1000 },
                { id: 'nexus_card', name: 'Nexus Карта', icon: '🔗', income: 50, price: 2500 },
                { id: 'ultra_card', name: 'Ультра Карта', icon: '💎', income: 100, price: 5000 },
                { id: 'infinity_card', name: 'Бесконечная Карта', icon: '♾️', income: 250, price: 10000 },
                { id: 'cosmic_card', name: 'Космическая Карта', icon: '🌌', income: 500, price: 25000 },
                { id: 'divine_card', name: 'Божественная Карта', icon: '👑', income: 1000, price: 50000 },
                { id: 'eternal_card', name: 'Вечная Карта', icon: '⏳', income: 2500, price: 100000 },
                { id: 'legendary_card', name: 'Легендарная Карта', icon: '🏆', income: 5000, price: 250000 },
                { id: 'mythical_card', name: 'Мифическая Карта', icon: '🌟', income: 10000, price: 500000 },
                { id: 'omnipotent_card', name: 'Всемогущая Карта', icon: '💫', income: 25000, price: 1000000 }
            ];
            
            const container = document.getElementById('cardsGrid');
            container.innerHTML = cards.map(card => `
                <div class="card-item">
                    <div class="card-icon">${card.icon}</div>
                    <div class="card-name">${card.name}</div>
                    <div class="card-income">+${card.income}/час</div>
                    <div class="card-price">${card.price.toLocaleString()} монет</div>
                </div>
            `).join('');
        }

        // Leaderboard functions
        function switchLeaderboardTab(tab) {
            document.querySelectorAll('.leaderboard-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            currentLeaderboardTab = tab;
            loadLeaderboard();
        }

        async function loadLeaderboard() {
            try {
                const response = await fetch(`/api/leaderboard?limit=10&type=${currentLeaderboardTab}`);
                const data = await response.json();
                
                if (data.success) {
                    const container = document.getElementById('leaderboardList');
                    container.innerHTML = data.leaderboard.map((player, index) => `
                        <div class="leaderboard-item">
                            <div class="leaderboard-rank ${index < 3 ? `top-${index + 1}` : ''}">${index + 1}</div>
                            <div class="leaderboard-info">
                                <div class="leaderboard-name">${player.username || 'Игрок'}</div>
                                <div class="leaderboard-value">
                                    ${currentLeaderboardTab === 'coins' ? 
                                        player.balance.toLocaleString() + ' монет' : 
                                        player.quanhash.toLocaleString() + ' QuanHash'
                                    }
                                </div>
                            </div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Ошибка загрузки лидерборда:', error);
            }
        }

        // News functions
        async function loadNews() {
            const news = [
                {
                    date: '15 января 2025',
                    title: '🚀 Запуск Quantum Nexus 2.0',
                    content: 'Мы рады объявить о запуске новой версии Quantum Nexus! Добавлены новые механики, улучшенный дизайн и множество новых возможностей для игроков.'
                },
                {
                    date: '10 января 2025',
                    title: '📈 Планы на листинг QuanHash',
                    content: 'Команда Quantum Nexus активно работает над подготовкой к листингу криптовалюты QuanHash на крупных биржах. Ожидаемая дата листинга - март 2025 года.'
                },
                {
                    date: '5 января 2025',
                    title: '🎉 Новогодние события',
                    content: 'В честь Нового года все игроки получают бонусные монеты и ускоренную добычу QuanHash до конца января!'
                }
            ];
            
            const container = document.getElementById('newsContent');
            container.innerHTML = news.map(item => `
                <div class="news-item">
                    <div class="news-date">${item.date}</div>
                    <div class="news-title">${item.title}</div>
                    <div class="news-content">${item.content}</div>
                </div>
            `).join('');
        }

        // Support functions
        document.getElementById('supportForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const category = document.getElementById('supportCategory').value;
            const message = document.getElementById('supportMessage').value;
            
            try {
                const response = await fetch('/api/support', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ category, message })
                });

                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    document.getElementById('supportForm').reset();
                } else {
                    showNotification(data.error || '❌ Ошибка отправки!', 'error');
                }
            } catch (error) {
                console.error('Ошибка отправки сообщения:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        });

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Energy regeneration
        setInterval(() => {
            if (gameState.energy < gameState.maxEnergy) {
                gameState.energy = Math.min(gameState.energy + gameState.energyRegenRate, gameState.maxEnergy);
                updateUI();
            }
        }, 1000);

        // Show beautiful offline earnings popup
        function showOfflineEarningsPopup() {
            const popup = document.createElement('div');
            popup.className = 'offline-popup';
            popup.innerHTML = `
                <div class="offline-popup-content">
                    <div class="offline-popup-header">
                        <h3>🎉 Добро пожаловать обратно!</h3>
                        <p>Вы отсутствовали ${gameState.hoursOffline} часов</p>
                    </div>
                    <div class="offline-popup-body">
                        <div class="offline-earnings">
                            <div class="earning-item">
                                <span class="earning-icon">💰</span>
                                <span class="earning-amount">+${gameState.offlineCoins.toLocaleString()} монет</span>
                            </div>
                            <div class="earning-item">
                                <span class="earning-icon">⛏️</span>
                                <span class="earning-amount">+${gameState.offlineHash.toLocaleString()} QuanHash</span>
                            </div>
                        </div>
                        <div class="offline-message">
                            Ваши машины продолжали работать пока вас не было!
                        </div>
                    </div>
                    <div class="offline-popup-footer">
                        <button class="offline-close-btn" onclick="this.parentElement.parentElement.parentElement.remove()">Отлично!</button>
                    </div>
                </div>
            `;
            
            // Add CSS for popup
            const style = document.createElement('style');
            style.textContent = `
                .offline-popup {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                    animation: fadeIn 0.3s ease-out;
                }
                .offline-popup-content {
                    background: linear-gradient(135deg, var(--dark), var(--dark-light));
                    border-radius: 20px;
                    padding: 30px;
                    max-width: 400px;
                    width: 90%;
                    border: 2px solid var(--crypto-gold);
                    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
                    animation: slideInUp 0.3s ease-out;
                }
                .offline-popup-header h3 {
                    color: var(--crypto-gold);
                    font-size: 1.5rem;
                    margin-bottom: 10px;
                    text-align: center;
                }
                .offline-popup-header p {
                    color: var(--gray-light);
                    text-align: center;
                    margin-bottom: 20px;
                }
                .offline-earnings {
                    display: grid;
                    gap: 15px;
                    margin-bottom: 20px;
                }
                .earning-item {
                    display: flex;
                    align-items: center;
                    gap: 15px;
                    padding: 15px;
                    background: var(--glass-hover);
                    border-radius: 12px;
                    border: 1px solid var(--border);
                }
                .earning-icon {
                    font-size: 1.5rem;
                }
                .earning-amount {
                    font-size: 1.2rem;
                    font-weight: 700;
                    color: var(--success);
                    font-family: 'JetBrains Mono', monospace;
                }
                .offline-message {
                    text-align: center;
                    color: var(--gray-light);
                    font-style: italic;
                    margin-bottom: 20px;
                }
                .offline-close-btn {
                    width: 100%;
                    padding: 15px;
                    border: none;
                    border-radius: 12px;
                    background: linear-gradient(135deg, var(--crypto-gold), var(--warning));
                    color: white;
                    font-weight: 600;
                    font-size: 1.1rem;
                    cursor: pointer;
                    transition: all 0.3s ease;
                }
                .offline-close-btn:hover {
                    transform: translateY(-2px);
                    box-shadow: var(--shadow-lg);
                }
                @keyframes slideInUp {
                    from { opacity: 0; transform: translateY(50px); }
                    to { opacity: 1; transform: translateY(0); }
                }
            `;
            document.head.appendChild(style);
            document.body.appendChild(popup);
            
            // Auto remove after 10 seconds
            setTimeout(() => {
                if (popup.parentElement) {
                    popup.remove();
                }
            }, 10000);
        }

        // Daily tasks functions
        async function loadDailyTasks() {
            try {
                const response = await fetch('/api/daily-tasks', {
                    headers: {
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    }
                });
                const data = await response.json();
                
                if (data.success) {
                    const container = document.getElementById('dailyTasksGrid');
                    container.innerHTML = data.tasks.map(task => `
                        <div class="task-item">
                            <div class="task-header">
                                <div class="task-title">${task.title}</div>
                                <div class="task-reward">${task.reward}</div>
                            </div>
                            <div class="task-description">${task.description}</div>
                            <div class="task-progress">
                                <div class="task-progress-bar" style="width: ${task.progress}%"></div>
                            </div>
                            <div class="task-progress-text">${task.current}/${task.target}</div>
                            <button class="task-button" onclick="claimTask('${task.id}')" ${task.completed ? 'disabled' : ''}>
                                ${task.completed ? 'Выполнено' : 'Выполнить'}
                            </button>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Ошибка загрузки заданий:', error);
            }
        }

        async function claimTask(taskId) {
            try {
                const response = await fetch('/api/claim-task', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ taskId })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.coins = data.newBalance;
                    gameState.quanhash = data.newQuanHash;
                    updateUI();
                    loadDailyTasks();
                } else {
                    showNotification(data.error || '❌ Ошибка получения награды!', 'error');
                }
            } catch (error) {
                console.error('Ошибка получения награды:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        async function claimLoginBonus() {
            try {
                const response = await fetch('/api/claim-login-bonus', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.coins = data.newBalance;
                    gameState.loginStreak = data.newStreak;
                    updateUI();
                    loadDailyTasks();
                } else {
                    showNotification(data.error || '❌ Ошибка получения бонуса!', 'error');
                }
            } catch (error) {
                console.error('Ошибка получения бонуса:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        // Referral functions
        async function loadReferralInfo() {
            try {
                const response = await fetch('/api/referral-info', {
                    headers: {
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    }
                });
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('referralCode').textContent = data.referralCode;
                    document.getElementById('referralsCount').textContent = data.referralsCount;
                    document.getElementById('referralEarnings').textContent = data.referralEarnings.toLocaleString() + ' монет';
                }
            } catch (error) {
                console.error('Ошибка загрузки реферальной информации:', error);
            }
        }

        function copyReferralCode() {
            const code = document.getElementById('referralCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showNotification('Реферальный код скопирован!', 'success');
            }).catch(() => {
                showNotification('Ошибка копирования', 'error');
            });
        }

        // Enhanced manual mining with animations
        async function mineQuanHash() {
            const energyAmount = parseInt(document.getElementById('energyAmount').value);
            
            if (!energyAmount || energyAmount < 10 || energyAmount > 100) {
                showNotification('❌ Введите количество энергии от 10 до 100!', 'error');
                return;
            }

            // Show mining animation
            const miningButton = document.querySelector('.mine-button');
            const originalText = miningButton.textContent;
            miningButton.textContent = '⛏️ Добыча...';
            miningButton.disabled = true;

            // Create mining animation
            const miningEffect = document.createElement('div');
            miningEffect.className = 'mining-effect';
            miningEffect.innerHTML = `
                <div class="mining-animation">
                    <div class="mining-particle"></div>
                    <div class="mining-particle"></div>
                    <div class="mining-particle"></div>
                </div>
            `;
            
            // Add mining animation CSS
            const miningStyle = document.createElement('style');
            miningStyle.textContent = `
                .mining-effect {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.7);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                    animation: fadeIn 0.3s ease-out;
                }
                .mining-animation {
                    position: relative;
                    width: 200px;
                    height: 200px;
                    border-radius: 50%;
                    border: 3px solid var(--crypto-gold);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    animation: miningRotate 2s linear infinite;
                }
                .mining-particle {
                    position: absolute;
                    width: 20px;
                    height: 20px;
                    background: var(--crypto-gold);
                    border-radius: 50%;
                    animation: miningPulse 1s ease-in-out infinite;
                }
                .mining-particle:nth-child(1) { top: 20px; left: 50%; transform: translateX(-50%); }
                .mining-particle:nth-child(2) { bottom: 20px; left: 50%; transform: translateX(-50%); }
                .mining-particle:nth-child(3) { top: 50%; right: 20px; transform: translateY(-50%); }
                @keyframes miningRotate {
                    from { transform: rotate(0deg); }
                    to { transform: rotate(360deg); }
                }
                @keyframes miningPulse {
                    0%, 100% { transform: scale(1); opacity: 1; }
                    50% { transform: scale(1.5); opacity: 0.7; }
                }
            `;
            document.head.appendChild(miningStyle);
            document.body.appendChild(miningEffect);

            try {
                const response = await fetch('/api/mine-quanhash', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ energyAmount })
                });

                const data = await response.json();
                
                // Remove animation after 2 seconds
                setTimeout(() => {
                    miningEffect.remove();
                    miningStyle.remove();
                    miningButton.textContent = originalText;
                    miningButton.disabled = false;
                }, 2000);
                
                if (data.success) {
                    setTimeout(() => {
                        showNotification(data.message, 'success');
                        gameState.quanhash = data.newQuanHash;
                        gameState.energy = data.newEnergy;
                        updateUI();
                    }, 2000);
                } else {
                    setTimeout(() => {
                        showNotification(data.error || '❌ Ошибка добычи!', 'error');
                    }, 2000);
                }
            } catch (error) {
                setTimeout(() => {
                    console.error('Ошибка добычи QuanHash:', error);
                    showNotification('❌ Ошибка подключения!', 'error');
                }, 2000);
            }
        }

        // Withdrawal functions
        async function loadWithdrawalInfo() {
            try {
                const response = await fetch('/api/withdrawal-info', {
                    headers: {
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    }
                });
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('withdrawalBalance').textContent = data.balance.toLocaleString();
                    document.querySelector('.balance-usdt').textContent = `≈ ${(data.balance / 500000).toFixed(4)} USDT`;
                    loadWithdrawalHistory();
                }
            } catch (error) {
                console.error('Ошибка загрузки информации о выводе:', error);
            }
        }

        async function loadWithdrawalHistory() {
            try {
                const response = await fetch('/api/withdrawal-history', {
                    headers: {
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    }
                });
                const data = await response.json();
                
                if (data.success) {
                    const container = document.getElementById('withdrawalHistory');
                    if (data.history.length === 0) {
                        container.innerHTML = '<div class="no-history">История выводов пуста</div>';
                    } else {
                        container.innerHTML = data.history.map(withdrawal => `
                            <div class="history-item">
                                <div class="history-info">
                                    <div class="history-amount">${withdrawal.amount.toLocaleString()} QuanHash</div>
                                    <div class="history-date">${new Date(withdrawal.created_at).toLocaleDateString()}</div>
                                </div>
                                <div class="history-status ${withdrawal.status}">
                                    ${withdrawal.status === 'pending' ? 'В обработке' : 
                                      withdrawal.status === 'completed' ? 'Выполнено' : 'Отклонено'}
                                </div>
                            </div>
                        `).join('');
                    }
                }
            } catch (error) {
                console.error('Ошибка загрузки истории выводов:', error);
            }
        }

        async function submitWithdrawal() {
            const usdtAddress = document.getElementById('usdtAddress').value.trim();
            
            if (!usdtAddress) {
                showNotification('❌ Введите USDT адрес!', 'error');
                return;
            }
            
            if (!usdtAddress.startsWith('0x') || usdtAddress.length !== 42) {
                showNotification('❌ Неверный формат USDT адреса!', 'error');
                return;
            }
            
            if (gameState.quanhash < 500000) {
                showNotification('❌ Недостаточно QuanHash для вывода!', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/submit-withdrawal', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ usdtAddress })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.quanhash = data.newBalance;
                    updateUI();
                    loadWithdrawalInfo();
                    document.getElementById('usdtAddress').value = '';
                } else {
                    showNotification(data.error || '❌ Ошибка создания заявки!', 'error');
                }
            } catch (error) {
                console.error('Ошибка создания заявки на вывод:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        // Auto mining functions
        function startAutoMiningVisualization() {
            if (gameState.level < 50) return;
            
            let progress = 0;
            const progressBar = document.getElementById('autoMiningProgress');
            const progressText = document.getElementById('autoMiningProgressText');
            
            const miningInterval = setInterval(() => {
                progress += 0.1;
                if (progress >= 100) {
                    progress = 0;
                    // Simulate mining reward
                    const reward = 0.1;
                    gameState.quanhash += reward;
                    updateUI();
                    showTapEffect(reward);
                }
                
                progressBar.style.width = progress + '%';
                progressText.textContent = `Добыча активна... ${progress.toFixed(1)}%`;
            }, 1000);
            
            // Store interval for cleanup
            window.autoMiningInterval = miningInterval;
        }

        function stopAutoMiningVisualization() {
            if (window.autoMiningInterval) {
                clearInterval(window.autoMiningInterval);
                window.autoMiningInterval = null;
            }
        }

        // Enhanced tap effects
        function showTapEffect(amount) {
            const effect = document.createElement('div');
            effect.className = 'tap-effect';
            effect.textContent = `+${amount}`;
            effect.style.left = Math.random() * 200 + 140 + 'px';
            effect.style.top = Math.random() * 100 + 300 + 'px';
            
            // Add enhanced styling
            effect.style.fontSize = '1.8rem';
            effect.style.fontWeight = '900';
            effect.style.color = '#f39c12';
            effect.style.textShadow = '0 0 20px #f39c12, 0 0 40px #f39c12';
            effect.style.animation = 'tapEffectAnimation 1.5s ease-out forwards';
            
            document.body.appendChild(effect);
            
            setTimeout(() => {
                effect.remove();
            }, 1500);
        }

        // Enhanced mining effects
        function showMiningEffect(amount) {
            const effect = document.createElement('div');
            effect.className = 'mining-effect';
            effect.innerHTML = `
                <div class="mining-effect-content">
                    <div class="mining-icon">⛏️</div>
                    <div class="mining-amount">+${amount} QuanHash</div>
                </div>
            `;
            
            // Add mining effect CSS
            const miningStyle = document.createElement('style');
            miningStyle.textContent = `
                .mining-effect {
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    z-index: 10000;
                    animation: miningEffectAnimation 2s ease-out forwards;
                }
                .mining-effect-content {
                    background: linear-gradient(135deg, var(--crypto-gold), var(--warning));
                    border-radius: 20px;
                    padding: 20px;
                    text-align: center;
                    box-shadow: 0 10px 30px rgba(243, 156, 18, 0.5);
                }
                .mining-icon {
                    font-size: 2rem;
                    margin-bottom: 10px;
                }
                .mining-amount {
                    font-size: 1.5rem;
                    font-weight: 800;
                    color: white;
                    font-family: 'JetBrains Mono', monospace;
                }
                @keyframes miningEffectAnimation {
                    0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
                    50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
                    100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
                }
            `;
            document.head.appendChild(miningStyle);
            document.body.appendChild(effect);
            
            setTimeout(() => {
                effect.remove();
                miningStyle.remove();
            }, 2000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            createCryptoParticles();
            initGame();
        });
    </script>
</body>
</html>