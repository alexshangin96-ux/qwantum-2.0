<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>⚛️ Quantum Nexus - Ultra Quantum Tapper</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #06b6d4;
            --dark: #0f172a;
            --dark-light: #1e293b;
            --gray: #64748b;
            --gray-light: #94a3b8;
            --white: #ffffff;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-hover: rgba(255, 255, 255, 0.1);
            --border: rgba(255, 255, 255, 0.1);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            min-height: 100vh;
            color: var(--white);
            overflow-x: hidden;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        /* Анимированный фон */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(16, 185, 129, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 60% 60%, rgba(6, 182, 212, 0.1) 0%, transparent 50%);
            animation: backgroundFloat 25s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes backgroundFloat {
            0%, 100% { transform: translate(0, 0) scale(1) rotate(0deg); }
            25% { transform: translate(-20px, -30px) scale(1.05) rotate(1deg); }
            50% { transform: translate(30px, -20px) scale(0.95) rotate(-1deg); }
            75% { transform: translate(-10px, 20px) scale(1.02) rotate(0.5deg); }
        }

        /* Частицы */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--primary);
            border-radius: 50%;
            animation: particleFloat 15s linear infinite;
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(100vh) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px);
                opacity: 0;
            }
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Header */
        .header {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-xl);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .header-left h1 {
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .header-left p {
            color: var(--gray-light);
            font-size: 0.9rem;
        }

        .header-right {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 5px;
        }

        .level-info {
            background: var(--glass-hover);
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--success);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .stat-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .stat-card-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--gray-light);
        }

        .stat-card-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .stat-card-icon.coins { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .stat-card-icon.hash { background: rgba(6, 182, 212, 0.2); color: var(--info); }

        .stat-card-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--white);
            margin-bottom: 5px;
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-card-change {
            font-size: 0.8rem;
            color: var(--gray-light);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stat-card-change.positive { color: var(--success); }
        .stat-card-change.negative { color: var(--danger); }

        /* Energy Bar */
        .energy-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .energy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .energy-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .energy-regen {
            font-size: 0.8rem;
            color: var(--gray-light);
            font-family: 'JetBrains Mono', monospace;
        }

        .energy-bar-container {
            position: relative;
            background: var(--glass-hover);
            border-radius: 12px;
            height: 20px;
            overflow: hidden;
        }

        .energy-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 12px;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .energy-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: energyShimmer 2s infinite;
        }

        @keyframes energyShimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .energy-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--white);
            font-family: 'JetBrains Mono', monospace;
        }

        /* Tap Button */
        .tap-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .tap-button {
            width: 200px;
            height: 200px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-size: 3rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.1s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 0 30px rgba(99, 102, 241, 0.3),
                0 0 60px rgba(139, 92, 246, 0.2),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
            animation: tapPulse 2s ease-in-out infinite;
        }

        @keyframes tapPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 
                    0 0 30px rgba(99, 102, 241, 0.3),
                    0 0 60px rgba(139, 92, 246, 0.2),
                    inset 0 0 20px rgba(255, 255, 255, 0.1);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 
                    0 0 40px rgba(99, 102, 241, 0.4),
                    0 0 80px rgba(139, 92, 246, 0.3),
                    inset 0 0 25px rgba(255, 255, 255, 0.15);
            }
        }

        .tap-button:hover {
            transform: scale(1.1);
            animation-play-state: paused;
        }

        .tap-button:active {
            transform: scale(0.95);
            animation-play-state: paused;
        }

        .tap-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, transparent 30%, rgba(255, 255, 255, 0.1) 100%);
            border-radius: 50%;
        }

        .tap-button::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
        }

        .tap-button:active::after {
            width: 100%;
            height: 100%;
        }

        .tap-power {
            margin-top: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            font-family: 'JetBrains Mono', monospace;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 6px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            padding: 12px 16px;
            text-align: center;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--gray-light);
            white-space: nowrap;
            min-width: 80px;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: var(--shadow);
        }

        .nav-tab:hover:not(.active) {
            background: var(--glass-hover);
            color: var(--white);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Shop Section */
        .shop-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .shop-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .shop-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 2px;
        }

        .shop-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .shop-category {
            padding: 8px 16px;
            border: 1px solid var(--border);
            border-radius: 20px;
            background: var(--glass-hover);
            color: var(--gray-light);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .shop-category.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .shop-category:hover:not(.active) {
            background: var(--glass);
            color: var(--white);
        }

        .shop-items {
            display: grid;
            gap: 15px;
        }

        .shop-item {
            background: var(--glass-hover);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .shop-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .shop-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .shop-item-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 5px;
        }

        .shop-item-price {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--success);
            font-family: 'JetBrains Mono', monospace;
        }

        .shop-item-description {
            font-size: 0.9rem;
            color: var(--gray-light);
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .shop-item-effect {
            background: var(--glass);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 0.8rem;
            color: var(--info);
            font-weight: 600;
        }

        .shop-item-button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .shop-item-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .shop-item-button:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Mining Section */
        .mining-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .mining-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mining-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--info), var(--success));
            border-radius: 2px;
        }

        .mining-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .mining-tab {
            flex: 1;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 12px;
            background: var(--glass-hover);
            color: var(--gray-light);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .mining-tab.active {
            background: var(--info);
            color: white;
            border-color: var(--info);
        }

        .mining-tab:hover:not(.active) {
            background: var(--glass);
            color: var(--white);
        }

        .mining-stats {
            background: var(--glass-hover);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .mining-stat {
            text-align: center;
        }

        .mining-stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--info);
            font-family: 'JetBrains Mono', monospace;
        }

        .mining-stat-label {
            font-size: 0.8rem;
            color: var(--gray-light);
            margin-top: 5px;
        }

        /* QuanHash Mining */
        .quanhash-mining {
            background: var(--glass-hover);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        .quanhash-mining h3 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quanhash-mining h3::before {
            content: '⛏️';
            font-size: 1.5rem;
        }

        .energy-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .energy-input {
            flex: 1;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: var(--glass);
            color: var(--white);
            font-size: 14px;
            text-align: center;
        }

        .energy-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .mine-button {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--info), var(--primary));
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mine-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .mine-button:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .mining-info {
            background: var(--glass);
            border-radius: 8px;
            padding: 10px;
            font-size: 0.8rem;
            color: var(--gray-light);
            text-align: center;
        }

        /* Cards Section */
        .cards-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .cards-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cards-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--warning), var(--danger));
            border-radius: 2px;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .card-item {
            background: var(--glass-hover);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--warning);
        }

        .card-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .card-name {
            font-size: 1rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 5px;
        }

        .card-income {
            font-size: 0.9rem;
            color: var(--success);
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .card-price {
            font-size: 1.1rem;
            color: var(--warning);
            font-weight: 800;
            margin-top: 10px;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Leaderboard */
        .leaderboard-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .leaderboard-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .leaderboard-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--success), var(--warning));
            border-radius: 2px;
        }

        .leaderboard-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .leaderboard-tab {
            flex: 1;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: var(--glass-hover);
            color: var(--gray-light);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .leaderboard-tab.active {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }

        .leaderboard-tab:hover:not(.active) {
            background: var(--glass);
            color: var(--white);
        }

        .leaderboard-list {
            display: grid;
            gap: 10px;
        }

        .leaderboard-item {
            background: var(--glass-hover);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .leaderboard-item:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .leaderboard-rank {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .leaderboard-rank.top-1 { background: linear-gradient(135deg, #ffd700, #ffed4e); color: #000; }
        .leaderboard-rank.top-2 { background: linear-gradient(135deg, #c0c0c0, #e5e5e5); color: #000; }
        .leaderboard-rank.top-3 { background: linear-gradient(135deg, #cd7f32, #daa520); color: #fff; }

        .leaderboard-info {
            flex: 1;
        }

        .leaderboard-name {
            font-weight: 600;
            color: var(--white);
            margin-bottom: 2px;
        }

        .leaderboard-value {
            font-size: 0.9rem;
            color: var(--gray-light);
            font-family: 'JetBrains Mono', monospace;
        }

        /* News Section */
        .news-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .news-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .news-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--info), var(--primary));
            border-radius: 2px;
        }

        .news-item {
            background: var(--glass-hover);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .news-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--info);
        }

        .news-item:last-child {
            margin-bottom: 0;
        }

        .news-date {
            font-size: 0.8rem;
            color: var(--gray-light);
            margin-bottom: 10px;
            font-family: 'JetBrains Mono', monospace;
        }

        .news-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 10px;
        }

        .news-content {
            font-size: 0.9rem;
            color: var(--gray-light);
            line-height: 1.5;
        }

        /* Support Section */
        .support-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-lg);
        }

        .support-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .support-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: linear-gradient(135deg, var(--warning), var(--danger));
            border-radius: 2px;
        }

        .support-form {
            display: grid;
            gap: 15px;
        }

        .form-group {
            display: grid;
            gap: 8px;
        }

        .form-group label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--white);
        }

        .form-group select,
        .form-group textarea {
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: var(--glass);
            color: var(--white);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .support-button {
            padding: 15px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--warning), var(--danger));
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .support-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 24px;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            animation: slideInDown 0.3s ease-out;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: var(--shadow-lg);
            max-width: 90%;
        }

        .notification.success {
            background: linear-gradient(135deg, var(--success), #059669);
        }

        .notification.error {
            background: linear-gradient(135deg, var(--danger), #dc2626);
        }

        .notification.info {
            background: linear-gradient(135deg, var(--info), #0891b2);
        }

        @keyframes slideInDown {
            from { opacity: 0; transform: translateX(-50%) translateY(-100%); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Tap Effects */
        .tap-effect {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--success);
            animation: tapEffectAnimation 1s ease-out forwards;
            text-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
        }

        @keyframes tapEffectAnimation {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5);
            }
        }

        /* Responsive */
        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .tap-button {
                width: 160px;
                height: 160px;
                font-size: 2.5rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .shop-categories {
                flex-wrap: wrap;
            }
            
            .cards-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
        }

        /* Telegram Web App specific styles */
        .tg-viewport {
            height: 100vh;
            overflow: hidden;
        }

        .tg-main-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 15px;
            font-weight: 600;
            cursor: pointer;
            z-index: 100;
            box-shadow: var(--shadow-lg);
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>
    
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="header-left">
                    <h1>⚛️ Quantum Nexus</h1>
                    <p>Ultra Quantum Tapper</p>
                </div>
                <div class="header-right">
                    <div class="level-info" id="levelInfo">
                        Уровень <span id="userLevel">1</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-card-header">
                    <div class="stat-card-title">💰 Монеты</div>
                    <div class="stat-card-icon coins">💎</div>
                </div>
                <div class="stat-card-value" id="coinsValue">0</div>
                <div class="stat-card-change positive" id="coinsPerHour">
                    <span>↗</span>
                    <span>+0/час</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-card-header">
                    <div class="stat-card-title">⛏️ QuanHash</div>
                    <div class="stat-card-icon hash">🔗</div>
                </div>
                <div class="stat-card-value" id="hashValue">0</div>
                <div class="stat-card-change positive" id="hashPerHour">
                    <span>↗</span>
                    <span>+0/час</span>
                </div>
            </div>
        </div>

        <!-- Energy Bar -->
        <div class="energy-section">
            <div class="energy-header">
                <div class="energy-title">
                    <span>⚡</span>
                    <span>Энергия</span>
                </div>
                <div class="energy-regen" id="energyRegen">+0.1/сек</div>
            </div>
            <div class="energy-bar-container">
                <div class="energy-bar" id="energyBar" style="width: 100%"></div>
                <div class="energy-text" id="energyText">1000/1000</div>
            </div>
        </div>

        <!-- Tap Button -->
        <div class="tap-section">
            <button class="tap-button" id="tapButton" onclick="tap()">
                ⚛️
            </button>
            <div class="tap-power" id="tapPower">+1 за клик</div>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="switchTab('shop')">🛒 Магазин</div>
            <div class="nav-tab" onclick="switchTab('mining')">⛏️ Майнинг</div>
            <div class="nav-tab" onclick="switchTab('cards')">🃏 Карты</div>
            <div class="nav-tab" onclick="switchTab('leaderboard')">🏆 Топ</div>
            <div class="nav-tab" onclick="switchTab('news')">📰 Новости</div>
            <div class="nav-tab" onclick="switchTab('support')">🆘 Поддержка</div>
        </div>

        <!-- Shop Tab -->
        <div class="tab-content active" id="shopTab">
            <div class="shop-section">
                <h2>🛒 Магазин Бустов</h2>
                <div class="shop-categories">
                    <div class="shop-category active" onclick="switchShopCategory('tap')">Тап</div>
                    <div class="shop-category" onclick="switchShopCategory('energy')">Энергия</div>
                    <div class="shop-category" onclick="switchShopCategory('passive')">Пассивный доход</div>
                    <div class="shop-category" onclick="switchShopCategory('auto')">Автотап</div>
                </div>
                
                <div class="shop-items" id="shopItems">
                    <!-- Shop items will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- Mining Tab -->
        <div class="tab-content" id="miningTab">
            <div class="mining-section">
                <h2>⛏️ Майнинг QuanHash</h2>
                <div class="mining-tabs">
                    <div class="mining-tab active" onclick="switchMiningTab('machines')">Машины</div>
                    <div class="mining-tab" onclick="switchMiningTab('premium')">Премиум</div>
                    <div class="mining-tab" onclick="switchMiningTab('manual')">Ручная добыча</div>
                </div>
                
                <div class="mining-stats">
                    <div class="mining-stat">
                        <div class="mining-stat-value" id="totalHashPerHour">0</div>
                        <div class="mining-stat-label">QuanHash/час</div>
                    </div>
                    <div class="mining-stat">
                        <div class="mining-stat-value" id="totalMachines">0</div>
                        <div class="mining-stat-label">Машин</div>
                    </div>
                </div>
                
                <div class="mining-content" id="miningContent">
                    <!-- Mining content will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- Cards Tab -->
        <div class="tab-content" id="cardsTab">
            <div class="cards-section">
                <h2>🃏 Коллекция Карт</h2>
                <div class="cards-grid" id="cardsGrid">
                    <!-- Cards will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- Leaderboard Tab -->
        <div class="tab-content" id="leaderboardTab">
            <div class="leaderboard-section">
                <h2>🏆 Лидерборд</h2>
                <div class="leaderboard-tabs">
                    <div class="leaderboard-tab active" onclick="switchLeaderboardTab('coins')">Монеты</div>
                    <div class="leaderboard-tab" onclick="switchLeaderboardTab('hash')">QuanHash</div>
                </div>
                <div class="leaderboard-list" id="leaderboardList">
                    <!-- Leaderboard will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- News Tab -->
        <div class="tab-content" id="newsTab">
            <div class="news-section">
                <h2>📰 Новости Quantum Nexus</h2>
                <div id="newsContent">
                    <!-- News will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- Support Tab -->
        <div class="tab-content" id="supportTab">
            <div class="support-section">
                <h2>🆘 Поддержка</h2>
                <form class="support-form" id="supportForm">
                    <div class="form-group">
                        <label for="supportCategory">Категория проблемы:</label>
                        <select id="supportCategory" required>
                            <option value="">Выберите категорию</option>
                            <option value="technical">Технические проблемы</option>
                            <option value="gameplay">Игровой процесс</option>
                            <option value="balance">Проблемы с балансом</option>
                            <option value="bug">Ошибки и баги</option>
                            <option value="suggestion">Предложения</option>
                            <option value="other">Другое</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="supportMessage">Опишите проблему:</label>
                        <textarea id="supportMessage" placeholder="Подробно опишите вашу проблему или предложение..." required></textarea>
                    </div>
                    <button type="submit" class="support-button">Отправить сообщение</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Game state
        let gameState = {
            user: null,
            coins: 0,
            quanhash: 0,
            level: 1,
            experience: 0,
            energy: 1000,
            maxEnergy: 1000,
            energyRegenRate: 0.1,
            coinsPerHour: 0,
            hashPerHour: 0,
            tapPower: 1,
            autoTapHours: 0,
            autoTapEndTime: 0,
            isBanned: false,
            isFrozen: false,
            freezeEndTime: 0,
            offlineCoins: 0,
            offlineHash: 0,
            hoursOffline: 0
        };

        let currentTab = 'shop';
        let currentShopCategory = 'tap';
        let currentMiningTab = 'machines';
        let currentLeaderboardTab = 'coins';

        // Initialize Telegram Web App
        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
            window.Telegram.WebApp.MainButton.hide();
        }

        // Create particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 20;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Initialize game
        async function initGame() {
            try {
                // Get Telegram init data
                const initData = window.Telegram?.WebApp?.initData || '';
                
                const response = await fetch('/api/auth', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': initData
                    },
                    body: JSON.stringify({ initData })
                });

                const data = await response.json();
                
                if (data.success) {
                    gameState = { ...gameState, ...data.user };
                    updateUI();
                    
                    // Show offline earnings notification
                    if (gameState.offlineCoins > 0 || gameState.offlineHash > 0) {
                        showNotification(
                            `💰 Оффлайн доход: ${gameState.offlineCoins.toLocaleString()} монет, ${gameState.offlineHash.toLocaleString()} QuanHash за ${gameState.hoursOffline}ч`,
                            'success'
                        );
                    }
                    
                    loadShopItems();
                    loadMiningContent();
                    loadCards();
                    loadLeaderboard();
                    loadNews();
                } else {
                    showNotification('❌ Ошибка авторизации!', 'error');
                }
            } catch (error) {
                console.error('Ошибка инициализации:', error);
                showNotification('❌ Ошибка подключения к серверу!', 'error');
            }
        }

        // Update UI
        function updateUI() {
            document.getElementById('coinsValue').textContent = gameState.coins.toLocaleString();
            document.getElementById('hashValue').textContent = gameState.quanhash.toLocaleString();
            document.getElementById('userLevel').textContent = gameState.level;
            document.getElementById('tapPower').textContent = `+${gameState.tapPower} за клик`;
            document.getElementById('coinsPerHour').innerHTML = `<span>↗</span><span>+${gameState.coinsPerHour}/час</span>`;
            document.getElementById('hashPerHour').innerHTML = `<span>↗</span><span>+${gameState.hashPerHour}/час</span>`;
            
            // Update energy
            const energyPercent = (gameState.energy / gameState.maxEnergy) * 100;
            document.getElementById('energyBar').style.width = energyPercent + '%';
            document.getElementById('energyText').textContent = `${gameState.energy}/${gameState.maxEnergy}`;
            document.getElementById('energyRegen').textContent = `+${gameState.energyRegenRate}/сек`;
            
            // Update mining stats
            document.getElementById('totalHashPerHour').textContent = gameState.hashPerHour.toLocaleString();
        }

        // Tap function
        async function tap() {
            if (gameState.energy < 1) {
                showNotification('❌ Недостаточно энергии!', 'error');
                return;
            }

            try {
                const response = await fetch('/api/tap', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    }
                });

                const data = await response.json();
                
                if (data.success) {
                    gameState.coins += data.coinsEarned;
                    gameState.experience += data.experienceEarned;
                    gameState.energy = data.newEnergy;
                    
                    updateUI();
                    
                    // Show tap effect
                    showTapEffect(data.coinsEarned);
                    
                    // Check for level up
                    const newLevel = Math.floor(gameState.experience / 1000) + 1;
                    if (newLevel > gameState.level) {
                        gameState.level = newLevel;
                        showNotification(`🎉 Уровень повышен до ${newLevel}!`, 'success');
                        updateUI();
                    }
                } else {
                    showNotification(data.error || '❌ Ошибка тапа!', 'error');
                }
            } catch (error) {
                console.error('Ошибка тапа:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        // Show tap effect
        function showTapEffect(amount) {
            const effect = document.createElement('div');
            effect.className = 'tap-effect';
            effect.textContent = `+${amount}`;
            effect.style.left = Math.random() * 200 + 140 + 'px';
            effect.style.top = Math.random() * 100 + 300 + 'px';
            document.body.appendChild(effect);
            
            setTimeout(() => {
                effect.remove();
            }, 1000);
        }

        // Switch tabs
        function switchTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.nav-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tab + 'Tab').classList.add('active');
            
            currentTab = tab;
        }

        // Shop functions
        function switchShopCategory(category) {
            document.querySelectorAll('.shop-category').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            currentShopCategory = category;
            loadShopItems();
        }

        function loadShopItems() {
            const shopItems = {
                tap: [
                    { id: 'tap_power_1', name: 'Усилитель Тапа', price: 100, description: 'Увеличивает силу тапа', effect: '+1 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_5', name: 'Мега Усилитель', price: 450, description: 'Значительно увеличивает силу тапа', effect: '+5 к силе тапа', coinsPerHour: 0 },
                    { id: 'tap_power_10', name: 'Ультра Усилитель', price: 800, description: 'Максимально увеличивает силу тапа', effect: '+10 к силе тапа', coinsPerHour: 0 }
                ],
                energy: [
                    { id: 'energy_capacity', name: 'Расширитель Энергии', price: 200, description: 'Увеличивает максимальную энергию', effect: '+100 к максимальной энергии', coinsPerHour: 0 },
                    { id: 'energy_regen', name: 'Регенератор', price: 300, description: 'Ускоряет восстановление энергии', effect: '+0.1 к скорости восстановления', coinsPerHour: 0 }
                ],
                passive: [
                    { id: 'coins_per_hour_50', name: 'Пассивный Доход', price: 500, description: 'Генерирует монеты каждый час', effect: '+50 монет/час', coinsPerHour: 50 },
                    { id: 'coins_per_hour_100', name: 'Усиленный Доход', price: 900, description: 'Больше пассивного дохода', effect: '+100 монет/час', coinsPerHour: 100 },
                    { id: 'coins_per_hour_200', name: 'Максимальный Доход', price: 1600, description: 'Максимальный пассивный доход', effect: '+200 монет/час', coinsPerHour: 200 }
                ],
                auto: [
                    { id: 'auto_tap_1h', name: 'Автотап 1ч', price: 1000, description: 'Автоматический тап на 1 час', effect: 'Автотап на 1 час', coinsPerHour: 0 },
                    { id: 'auto_tap_3h', name: 'Автотап 3ч', price: 2500, description: 'Автоматический тап на 3 часа', effect: 'Автотап на 3 часа', coinsPerHour: 0 },
                    { id: 'auto_tap_12h', name: 'Автотап 12ч', price: 8000, description: 'Автоматический тап на 12 часов', effect: 'Автотап на 12 часов', coinsPerHour: 0 },
                    { id: 'auto_tap_24h', name: 'Автотап 24ч', price: 15000, description: 'Автоматический тап на 24 часа', effect: 'Автотап на 24 часа', coinsPerHour: 0 }
                ]
            };

            const items = shopItems[currentShopCategory] || [];
            const container = document.getElementById('shopItems');
            
            container.innerHTML = items.map(item => `
                <div class="shop-item">
                    <div class="shop-item-header">
                        <div>
                            <div class="shop-item-title">${item.name}</div>
                            <div class="shop-item-description">${item.description}</div>
                        </div>
                        <div class="shop-item-price">${item.price.toLocaleString()}</div>
                    </div>
                    <div class="shop-item-effect">${item.effect}</div>
                    <button class="shop-item-button" onclick="buyBoost('${item.id}')" ${gameState.coins < item.price ? 'disabled' : ''}>
                        ${gameState.coins < item.price ? 'Недостаточно монет' : 'Купить'}
                    </button>
                </div>
            `).join('');
        }

        async function buyBoost(boostId) {
            try {
                const response = await fetch('/api/buy-boost', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ boostId, boostType: 'boost' })
                });

                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.coins = data.newBalance;
                    updateUI();
                    loadShopItems();
                } else {
                    showNotification(data.error || '❌ Ошибка покупки!', 'error');
                }
            } catch (error) {
                console.error('Ошибка покупки:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        // Mining functions
        function switchMiningTab(tab) {
            document.querySelectorAll('.mining-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            currentMiningTab = tab;
            loadMiningContent();
        }

        function loadMiningContent() {
            const container = document.getElementById('miningContent');
            
            if (currentMiningTab === 'machines') {
                const machines = [
                    { id: 'basic_miner', name: 'Базовый Майнер', price: 1000, hashPerHour: 10, description: 'Простая майнинг машина' },
                    { id: 'advanced_miner', name: 'Продвинутый Майнер', price: 5000, hashPerHour: 50, description: 'Улучшенная майнинг машина' },
                    { id: 'quantum_miner', name: 'Квантовый Майнер', price: 15000, hashPerHour: 150, description: 'Высокотехнологичный майнер' },
                    { id: 'nexus_miner', name: 'Nexus Майнер', price: 50000, hashPerHour: 500, description: 'Элитная майнинг машина' },
                    { id: 'ultra_miner', name: 'Ультра Майнер', price: 150000, hashPerHour: 1500, description: 'Легендарная майнинг машина' }
                ];
                
                container.innerHTML = machines.map(machine => `
                    <div class="shop-item">
                        <div class="shop-item-header">
                            <div>
                                <div class="shop-item-title">${machine.name}</div>
                                <div class="shop-item-description">${machine.description}</div>
                            </div>
                            <div class="shop-item-price">${machine.price.toLocaleString()}</div>
                        </div>
                        <div class="shop-item-effect">+${machine.hashPerHour} QuanHash/час</div>
                        <button class="shop-item-button" onclick="buyMiningMachine('${machine.id}')" ${gameState.coins < machine.price ? 'disabled' : ''}>
                            ${gameState.coins < machine.price ? 'Недостаточно монет' : 'Купить за монеты'}
                        </button>
                    </div>
                `).join('');
            } else if (currentMiningTab === 'premium') {
                const premiumMachines = [
                    { id: 'quantum_core', name: 'Квантовое Ядро', price: 1000, hashPerHour: 1000, description: 'Премиум майнинг ядро' },
                    { id: 'nexus_core', name: 'Nexus Ядро', price: 5000, hashPerHour: 5000, description: 'Элитное майнинг ядро' },
                    { id: 'ultra_core', name: 'Ультра Ядро', price: 15000, hashPerHour: 15000, description: 'Легендарное майнинг ядро' },
                    { id: 'infinity_core', name: 'Бесконечное Ядро', price: 50000, hashPerHour: 50000, description: 'Мифическое майнинг ядро' },
                    { id: 'cosmic_core', name: 'Космическое Ядро', price: 150000, hashPerHour: 150000, description: 'Божественное майнинг ядро' }
                ];
                
                container.innerHTML = premiumMachines.map(machine => `
                    <div class="shop-item">
                        <div class="shop-item-header">
                            <div>
                                <div class="shop-item-title">${machine.name}</div>
                                <div class="shop-item-description">${machine.description}</div>
                            </div>
                            <div class="shop-item-price">${machine.price.toLocaleString()} QuanHash</div>
                        </div>
                        <div class="shop-item-effect">+${machine.hashPerHour} QuanHash/час</div>
                        <button class="shop-item-button" onclick="buyPremiumMachine('${machine.id}')" ${gameState.quanhash < machine.price ? 'disabled' : ''}>
                            ${gameState.quanhash < machine.price ? 'Недостаточно QuanHash' : 'Купить за QuanHash'}
                        </button>
                    </div>
                `).join('');
            } else if (currentMiningTab === 'manual') {
                container.innerHTML = `
                    <div class="quanhash-mining">
                        <h3>Ручная добыча QuanHash</h3>
                        <div class="energy-input-group">
                            <input type="number" class="energy-input" id="energyAmount" placeholder="Энергия" min="10" max="100" value="10">
                            <button class="mine-button" onclick="mineQuanHash()">Добыть</button>
                        </div>
                        <div class="mining-info">
                            💡 Дорого и медленно, но можно добывать QuanHash вручную за энергию
                        </div>
                    </div>
                `;
            }
        }

        async function buyMiningMachine(machineId) {
            try {
                const response = await fetch('/api/buy-mining-machine', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ machineId })
                });

                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.coins = data.newBalance;
                    gameState.hashPerHour = data.newHashPerHour;
                    updateUI();
                    loadMiningContent();
                } else {
                    showNotification(data.error || '❌ Ошибка покупки!', 'error');
                }
            } catch (error) {
                console.error('Ошибка покупки машины:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        async function buyPremiumMachine(machineId) {
            try {
                const response = await fetch('/api/buy-premium-machine', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ machineId })
                });

                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.quanhash = data.newQuanHash;
                    gameState.hashPerHour = data.newHashPerHour;
                    updateUI();
                    loadMiningContent();
                } else {
                    showNotification(data.error || '❌ Ошибка покупки!', 'error');
                }
            } catch (error) {
                console.error('Ошибка покупки премиум машины:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        async function mineQuanHash() {
            const energyAmount = parseInt(document.getElementById('energyAmount').value);
            
            if (!energyAmount || energyAmount < 10 || energyAmount > 100) {
                showNotification('❌ Введите количество энергии от 10 до 100!', 'error');
                return;
            }

            try {
                const response = await fetch('/api/mine-quanhash', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ energyAmount })
                });

                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    gameState.quanhash = data.newQuanHash;
                    gameState.energy = data.newEnergy;
                    updateUI();
                } else {
                    showNotification(data.error || '❌ Ошибка добычи!', 'error');
                }
            } catch (error) {
                console.error('Ошибка добычи QuanHash:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        }

        // Cards functions
        function loadCards() {
            const cards = [
                { id: 'quantum_card', name: 'Квантовая Карта', icon: '⚛️', income: 25, price: 1000 },
                { id: 'nexus_card', name: 'Nexus Карта', icon: '🔗', income: 50, price: 2500 },
                { id: 'ultra_card', name: 'Ультра Карта', icon: '💎', income: 100, price: 5000 },
                { id: 'infinity_card', name: 'Бесконечная Карта', icon: '♾️', income: 250, price: 10000 },
                { id: 'cosmic_card', name: 'Космическая Карта', icon: '🌌', income: 500, price: 25000 }
            ];
            
            const container = document.getElementById('cardsGrid');
            container.innerHTML = cards.map(card => `
                <div class="card-item">
                    <div class="card-icon">${card.icon}</div>
                    <div class="card-name">${card.name}</div>
                    <div class="card-income">+${card.income}/час</div>
                    <div class="card-price">${card.price.toLocaleString()} монет</div>
                </div>
            `).join('');
        }

        // Leaderboard functions
        function switchLeaderboardTab(tab) {
            document.querySelectorAll('.leaderboard-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            currentLeaderboardTab = tab;
            loadLeaderboard();
        }

        async function loadLeaderboard() {
            try {
                const response = await fetch(`/api/leaderboard?limit=10&type=${currentLeaderboardTab}`);
                const data = await response.json();
                
                if (data.success) {
                    const container = document.getElementById('leaderboardList');
                    container.innerHTML = data.leaderboard.map((player, index) => `
                        <div class="leaderboard-item">
                            <div class="leaderboard-rank ${index < 3 ? `top-${index + 1}` : ''}">${index + 1}</div>
                            <div class="leaderboard-info">
                                <div class="leaderboard-name">${player.username || 'Игрок'}</div>
                                <div class="leaderboard-value">
                                    ${currentLeaderboardTab === 'coins' ? 
                                        player.balance.toLocaleString() + ' монет' : 
                                        player.quanhash.toLocaleString() + ' QuanHash'
                                    }
                                </div>
                            </div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Ошибка загрузки лидерборда:', error);
            }
        }

        // News functions
        async function loadNews() {
            const news = [
                {
                    date: '15 января 2025',
                    title: '🚀 Запуск Quantum Nexus 2.0',
                    content: 'Мы рады объявить о запуске новой версии Quantum Nexus! Добавлены новые механики, улучшенный дизайн и множество новых возможностей для игроков.'
                },
                {
                    date: '10 января 2025',
                    title: '📈 Планы на листинг QuanHash',
                    content: 'Команда Quantum Nexus активно работает над подготовкой к листингу криптовалюты QuanHash на крупных биржах. Ожидаемая дата листинга - март 2025 года.'
                },
                {
                    date: '5 января 2025',
                    title: '🎉 Новогодние события',
                    content: 'В честь Нового года все игроки получают бонусные монеты и ускоренную добычу QuanHash до конца января!'
                }
            ];
            
            const container = document.getElementById('newsContent');
            container.innerHTML = news.map(item => `
                <div class="news-item">
                    <div class="news-date">${item.date}</div>
                    <div class="news-title">${item.title}</div>
                    <div class="news-content">${item.content}</div>
                </div>
            `).join('');
        }

        // Support functions
        document.getElementById('supportForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const category = document.getElementById('supportCategory').value;
            const message = document.getElementById('supportMessage').value;
            
            try {
                const response = await fetch('/api/support', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': window.Telegram?.WebApp?.initData || ''
                    },
                    body: JSON.stringify({ category, message })
                });

                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    document.getElementById('supportForm').reset();
                } else {
                    showNotification(data.error || '❌ Ошибка отправки!', 'error');
                }
            } catch (error) {
                console.error('Ошибка отправки сообщения:', error);
                showNotification('❌ Ошибка подключения!', 'error');
            }
        });

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Energy regeneration
        setInterval(() => {
            if (gameState.energy < gameState.maxEnergy) {
                gameState.energy = Math.min(gameState.energy + gameState.energyRegenRate, gameState.maxEnergy);
                updateUI();
            }
        }, 1000);

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            createParticles();
            initGame();
        });
    </script>
</body>
</html>